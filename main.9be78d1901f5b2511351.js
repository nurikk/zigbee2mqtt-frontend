(self.webpackChunkzigbee2mqtt_frontend=self.webpackChunkzigbee2mqtt_frontend||[]).push([[179],{84848:(e,t,n)=>{"use strict";var r=n(67294);const a={container:"_1TK12NlMUcpu0IZGw5KG9F",img:"-vLZFy4QqTaA5Lql2j7WL",node:"_3VABKCYaUBV0N55MRkEiCg",link:"_2MMYgLsCQ5mPT-AJSdZ4Uz",linkLabel:"EFSV-Lj6sJyoW14QA3ig0",links:"_3m9RTJKJZqiJx1UmLLzi4",nodes:"_1RxBn1bAxqYxk5W0mPwZMS",EndDevice:"JhUbmgThutQMk8laPcsxg",Coordinator:"_3F14ZWmKtSPPHai2y_MRRj",Router:"_1I1ZcuMgRbn_B5HXF9Z2mw",BrokenLink:"_3FeEi6FG3R9pYpboNF-OBu",Coordinator2Router:"_2cFMSmedVqD5hjj2K7XpsQ",Router2Coordinator:"_3KnTt0kzrMwLh56UMBBqwe",Router2Router:"_3HeSfltIQjH_mQxhaoHnCs",Coordinator2EndDevice:"_2zGuiMZ7r-Z4mfRvCVQEAp",EndDevice2Coordinator:"_35uGMHQCj1Sx5FyJk5-Ec1",Router2EndDevice:"_1nD8O-bIFFZWctv6x4zD8j",EndDevice2Router:"_2tVxslI3DwN1gBA6s3V24b",foreignObject:"_1PgTRqMkYD7R1RqIF7R5ni",offline:"_3goiiMv86rV5wazL6jDpjU",controls:"RIAc5GeET4TLTKyCVy7yK"};var o=n(94184),i=n.n(o),l=n(94017),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},s=function(e){var t=e.link.linkType,n=e.id,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["link","id"]);return r.createElement("path",c({id:n,className:i()(a.link,a[t]),strokeWidth:1,fill:"transparent"},o))},u=function(e){var t=e.link;return r.createElement("text",{className:a.linkLabel},t.linkqualities.join("/"))};const p=function(e){var t=e.links,n=(0,r.useRef)();return(0,r.useLayoutEffect)((function(){(0,l.Z)(n.current).selectAll("."+a.link).data(t),(0,l.Z)(n.current).selectAll("."+a.linkLabel).data(t)}),[t.length]),r.createElement("g",{ref:n,className:a.links},t.map((function(e){return r.createElement(s,{id:"edgepath"+e.sourceIeeeAddr+"-"+e.targetIeeeAddr+"-"+e.linkType,key:"link"+e.sourceIeeeAddr+"-"+e.targetIeeeAddr+"-"+e.linkType,link:e})})),t.map((function(e){return r.createElement(u,{xlinkHref:"#edgepath"+e.sourceIeeeAddr+"-"+e.targetIeeeAddr+"-"+e.linkType,key:"label"+e.sourceIeeeAddr+"-"+e.targetIeeeAddr+"-"+e.linkType,link:e})})))};var m=n(48454),d=n(9327),f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},v=function(e){return"/device/"+e},h=function(e,t){return void 0===t&&(t=4),"0x"+(""+"0".repeat(t)+e.toString(16)).substr(-1*t).toUpperCase()},y=function(e,t){return e||t?(n=void 0!==t?Date.now()-t:"string"==typeof e?Date.parse(e):new Date(e),(0,d.WU)(n)):"N/A";var n},g=function(e){var t={},n=new Map;return e.nodes.forEach((function(e){t[e.ieeeAddr]=e})),e.links.sort((function(e,t){return e.relationship-t.relationship})).forEach((function(e){var r=t[e.source.ieeeAddr],a=t[e.target.ieeeAddr];if(r&&a){var o=[e.source.ieeeAddr,e.target.ieeeAddr].sort().join(""),i=n.get(o),l=[r.type,a.type].join("2");i?(i.linkqualities.push(e.linkquality),i.relationships.push(e.relationship)):n.set(o,f(f({},e),{source:e.source.ieeeAddr,linkType:l,target:e.target.ieeeAddr,linkqualities:[e.linkquality],relationships:[e.relationship]}))}else console.warn("Broken link",e)})),e.links=Array.from(n.values()),e},b=function(e){return Math.random().toString(36).substr(2,e)};function E(e,t){var n=this[e];return n instanceof Map?{dataType:"Map",value:Array.from(n.entries())}:t}var _=function(e){return JSON.stringify(e,E)},k=function(e,t){var n=new Blob([_(e)],{type:"octet/stream"}),r=window.URL.createObjectURL(n),a=document.createElement("a");document.body.appendChild(a),a.href=r,a.download=t,setTimeout((function(){a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}),1)},O=function(e){return e?e.endpoints?Array.from(e.endpoints.keys()):e.members?e.members.map((function(e){return e.endpoint})):[]:[]},N=function(e){return JSON.stringify(e,(function(e,t){return void 0===t?null:t}))},w=function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},C=function(e){return m},S=[function(e){var t,n;return"https://www.zigbee2mqtt.io/images/devices/"+((n=null===(t=null==e?void 0:e.definition)||void 0===t?void 0:t.model)?n.replace(/:|\s|\//g,"-"):"NA")+".jpg"},function(e){return"https://slsys.github.io/Gateway/devices/png/"+(null==(t=e.model_id)?void 0:t.replace("/","_"))+".png";var t},C];const x=function(e){var t,n,a=(0,r.useState)(S),o=a[0],l=a[1],c=e.device,s=e.deviceStatus,u=e.type,p=void 0===u?"img":u,m=e.className,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["device","deviceStatus","type","className"]),f=C();(null===(t=null==c?void 0:c.definition)||void 0===t?void 0:t.model)&&o.length&&(f=o[0](c));var v=function(){var e=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,l=o.length;i<l;i++,a++)r[a]=o[i];return r}(o);e.shift(),l(e)},h="updating"===(null===(n=null==s?void 0:s.update)||void 0===n?void 0:n.state)?r.createElement("i",{title:"Updating firmware",className:"fa fa-sync fa-spin position-absolute bottom-0 right-0"}):null,y=c.interviewing?r.createElement("i",{title:"Interviewing",className:"fa fa-spinner fa-spin position-absolute bottom-0 right-0"}):null,g=c.interviewing||c.interview_completed?null:r.createElement("i",{title:"Interview failed",className:"fa fa-exclamation-triangle position-absolute top-0 right-0 text-danger"});switch(p){case"svg":return f?r.createElement("image",w({},d,{onError:v,href:f})):null;case"img":default:return f?r.createElement("div",w({className:i()(m,"position-relative")},d),r.createElement("img",{onError:v,src:f,className:"position-relative"}),y,h,g):null}};var j,P=n(52601),A=(j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),R=function(e,t,n){for(var r=Math.PI/e,a=2*e,o="",i=0;i<a;i++){var l=i%2==0?n:t;o+=15+Math.cos(i*r+60)*l+", "+(15+Math.sin(i*r+60)*l)+" "}return o},I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=(0,r.createRef)(),t.onMouseOut=function(){var e=t.props,n=e.node,r=e.onMouseOut;t.ref&&t.ref.current&&r&&r(n,t.ref.current)},t.onMouseOver=function(){var e=t.props,n=e.node,r=e.onMouseOver;t.ref&&t.ref.current&&r&&r(n,t.ref.current)},t.onDblClick=function(){var e=t.props,n=e.node,r=e.onDblClick;t.ref&&t.ref.current&&r&&r(n,t.ref.current)},t}return A(t,e),t.prototype.componentDidMount=function(){var e=this.ref.current,t=this.props.node;(0,l.Z)(e).data([t])},t.prototype.render=function(){var e=this.props.node,t=this,n=t.onMouseOver,o=t.onMouseOut,l=t.onDblClick,c=e.type,s=i()(a.node,a[c]);return r.createElement("g",{className:s,ref:this.ref,onMouseOver:n,onMouseOut:o,onDoubleClick:l},"Coordinator"===e.type?r.createElement("polygon",{points:R(5,5,14)}):r.createElement(x,{type:"svg",width:32,height:32,device:e,className:""+a.img}),r.createElement("text",null,e.friendlyName))},t}(r.Component);const D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={toggle:!1},t}return A(t,e),t.prototype.updateDrag=function(){var e=this.props,t=e.simulation,n=e.root,r=(0,P.Z)().on("start",(function(e,n){e.active||t.alphaTarget(.3).restart(),n.fx=n.x,n.fy=n.y})).on("drag",(function(e,t){var n=e.x,r=e.y;t.fx=n,t.fy=r})).on("end",(function(e,n){e.active||t.alphaTarget(0),n.fx=void 0,n.fy=void 0}));(0,l.Z)(n).selectAll("."+a.node).call(r)},t.prototype.componentDidMount=function(){this.updateDrag()},t.prototype.componentDidUpdate=function(){this.updateDrag()},t.prototype.render=function(){var e=this.props,t=e.nodes,n=e.onMouseOut,o=e.onMouseOver;return r.createElement("g",{className:a.nodes},t.map((function(e){return r.createElement(I,{onMouseOut:n,onMouseOver:o,key:e.ieeeAddr,node:e})})))},t}(r.Component);var T;!function(e){e[e.NeigbhorIsParent=0]="NeigbhorIsParent",e[e.NeigbhorIsAChild=1]="NeigbhorIsAChild",e[e.NeigbhorIsASibling=2]="NeigbhorIsASibling",e[e.NoneOfTheAbove=3]="NoneOfTheAbove",e[e.NeigbhorIsAFormerChild=4]="NeigbhorIsAFormerChild"}(T||(T={}));var M,F=n(42599),L=n(22003),q=n(72720),G=(n(12512),n(59858));const B=(0,q.Z)((M=G,JSON.parse(M,(function(e,t){return"object"==typeof t&&null!==t&&"Map"===t.dataType?new Map(t.value):t}))));var U=n(46685),W=n(75472),Z=n.n(W),H=function(){return(H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},V="z2m-token",z="z2m-auth",J=new U.Iq,Q=[/MQTT publish/],$=function(e){var t,n="",r="";if(void 0!==(t=e).level&&void 0!==t.message)n=e.message,r=e.level;else if(function(e){return void 0!==e.status}(e))switch(e.status){case"error":r="error",n=e.error}switch(r){case"error":case"warning":J.error(n);break;case"info":J.success(n)}},K=function(){function e(e){var t=this;this.requests=new Map,this.transactionNumber=1,this.send=function(e,n){if(console.debug("Calling API",{topic:e,payload:n}),e.startsWith("bridge/request/")){var r=t.transactionRndPreffix+"-"+t.transactionNumber++,a=new Promise((function(e,n){t.requests.set(r,[e,n])}));return t.socket.send(N({topic:e,payload:H(H({},n),{transaction:r})})),a}return t.socket.send(N({topic:e,payload:n})),Promise.resolve()},this.urlProvider=function(){return e=t,n=void 0,a=function(){var e,t;return function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(n){return e=new URL(this.url),t=localStorage.getItem(V),!!localStorage.getItem(z)&&(t||(t=prompt("enter your z2m admin token"),localStorage.setItem(V,t)),e.searchParams.append("token",t)),[2,e.toString()]}))},new((r=void 0)||(r=Promise))((function(t,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function l(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,l)}c((a=a.apply(e,n||[])).next())}));var e,n,r,a},this.procsessBridgeMessage=function(e){var n;switch(e.topic){case"bridge/config":B.setState({bridgeConfig:e.payload});break;case"bridge/info":B.setState({bridgeInfo:e.payload});break;case"bridge/state":B.setState({bridgeState:e.payload});break;case"bridge/devices":var r=new Map;Z()(e.payload,"friendly_name").forEach((function(e){var t=H({},e);t.endpoints=new Map(Object.entries(e.endpoints)),r.set(e.ieee_address,t)})),B.setState({devices:r});break;case"bridge/groups":B.setState({groups:e.payload});break;case"bridge/event":break;case"bridge/extensions":var a=B.getState().extensionCode,o=H({},a);e.payload.forEach((function(e){o[e]||(o[e]="")})),B.setState({extensionCode:o});break;case"bridge/logging":var i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,l=o.length;i<l;i++,a++)r[a]=o[i];return r}(B.getState().logs.slice(-100));i.push(e.payload),B.setState({logs:i});var l=e.payload;Q.every((function(e){return!e.test(l.message)}))&&$(l);break;case"bridge/response/networkmap":var c=e.payload;if("ok"==c.status){var s=c.data.value;B.setState({networkGraphIsLoading:!1,networkGraph:g(s)})}else B.setState({networkGraphIsLoading:!1});break;case"bridge/response/touchlink/scan":var u=e.payload,p=u.status,m=u.data;"ok"===p?B.setState({touchlinkScanInProgress:!1,touchlinkDevices:m.found}):B.setState({touchlinkScanInProgress:!1});break;case"bridge/response/touchlink/identify":B.setState({touchlinkIdentifyInProgress:!1});break;case"bridge/response/touchlink/factory_reset":B.setState({touchlinkResetInProgress:!1});break;case"bridge/extension/response/read":console.log(e.payload);var d=B.getState().extensionCode,f=e.payload.data,v=f.name,h=f.content;B.setState({extensionCode:H(H({},d),(n={},n[v]=h,n))})}e.topic.startsWith("bridge/response/")&&($(e.payload),t.resolvePromises(e.payload))},this.onClose=function(e){4401===e.code&&(localStorage.setItem(z,"true"),localStorage.removeItem(V),J.error("Unauthorized"),setTimeout((function(){window.location.reload()}),1e3))},this.onMessage=function(e){var n={};try{n=JSON.parse(e.data)}catch(t){J.error(t.message),J.error(e.data)}if(n.topic.startsWith("bridge/"))t.procsessBridgeMessage(n);else{var r=B.getState().deviceStates,a=new Map(r);a.set(n.topic,H(H({},a.get(n.topic)),n.payload)),B.setState({deviceStates:a})}},this.url=e,this.transactionRndPreffix=b(5)}return e.prototype.connect=function(){this.socket=new L.Z(this.urlProvider),this.socket.addEventListener("message",this.onMessage),this.socket.addEventListener("close",this.onClose)},e.prototype.resolvePromises=function(e){var t=e.transaction,n=e.status;if(void 0!==t&&this.requests.has(t)){var r=this.requests.get(t),a=r[0],o=r[1];"ok"==n||null==n?a():o(),this.requests.delete(t)}},e}(),Y=""+window.location.host+document.location.pathname+"api";const X=new K(("https:"===location.protocol?"wss":"ws")+"://"+Y),ee={setPermitJoin:function(e,t,n){return void 0===t&&(t=!0),X.send("bridge/request/permit_join",{value:t,device:null==n?void 0:n.friendly_name})},updateBridgeConfig:function(e,t){return X.send("bridge/request/options",{options:t})},restartBridge:function(e){return X.send("bridge/request/restart",{})}},te={renameDevice:function(e,t,n,r){return X.send("bridge/request/device/rename",{from:t,to:n,homeassistant_rename:r})},removeDevice:function(e,t,n,r){return X.send("bridge/request/device/remove",{id:t,force:n,block:r})},configureDevice:function(e,t){return X.send("bridge/request/device/configure",{id:t})},setDeviceOptions:function(e,t,n){return X.send("bridge/request/device/options",{id:t,options:n})}},ne={createGroup:function(e,t,n){var r={friendly_name:t};return n&&(r.id=n),X.send("bridge/request/group/add",r)},removeGroup:function(e,t){return X.send("bridge/request/group/remove",{id:t})},addDeviceToGroup:function(e,t,n){return X.send("bridge/request/group/members/add",{group:n,device:t})},removeDeviceFromGroup:function(e,t,n){return X.send("bridge/request/group/members/remove",{device:t,group:n})},renameGroup:function(e,t,n){return X.send("bridge/request/group/rename",{from:t,to:n})}},re={setStateValue:function(e,t,n,r){var a;return X.send(t+"/set",((a={})[n]=r,a))},setDeviceState:function(e,t,n){return X.send(t+"/set",n)},getDeviceState:function(e,t,n){return X.send(t+"/get",n)}},ae={checkOTA:function(e,t){return X.send("bridge/request/device/ota_update/check",{id:t})},updateOTA:function(e,t){return X.send("bridge/request/device/ota_update/update",{id:t})}};var oe=function(e,t){return X.send("bridge/request/device/"+e,t)};const ie={addBind:function(e,t){return oe("bind",t)},removeBind:function(e,t){return oe("unbind",t)}},le={touchlinkScan:function(e){return B.setState({touchlinkScanInProgress:!0,touchlinkDevices:[]}),X.send("bridge/request/touchlink/scan",{value:!0})},touchlinkIdentify:function(e,t){return B.setState({touchlinkIdentifyInProgress:!0}),X.send("bridge/request/touchlink/identify",t)},touchlinkReset:function(e,t){return B.setState({touchlinkResetInProgress:!0}),X.send("bridge/request/touchlink/factory_reset",t)}};var ce=function(){return(ce=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const se={readExtension:function(e,t){return X.send("bridge/extension/request/read",{name:t})},updateExtensionCode:function(e,t,n){var r,a=e.extensionCode;return B.setState({extensionCode:ce(ce({},a),(r={},r[t]=n,r))}),Promise.resolve()},saveExtensionCode:function(e,t){var n=e.extensionCode;return X.send("bridge/extension/request/save",{name:t,content:n[t]})}};var ue=function(){return(ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const pe=function(e){return ue(ue(ue(ue(ue(ue(ue(ue(ue({},ee),te),ne),re),ae),ie),le),se),{networkMapRequest:function(t){return e.setState({networkGraphIsLoading:!0,networkGraph:{nodes:[],links:[]}}),X.send("bridge/request/networkmap",{type:"raw",routes:!1})},exportState:function(e){return k(e,"state.json"),Promise.resolve()},configureReport:function(e,t,n){return X.send("bridge/request/device/configure_reporting",ue({id:t},n))}})};var me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(){return(de=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){var e=t.props,n=e.item,r=e.onClick,a=e.promt,o=!0;a&&(o=confirm("string"==typeof a?a:"Are you sure?")),o&&r&&r(n)},t}return me(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=(e.item,e.promt,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["children","item","promt"]));return r.createElement("button",de({type:"button"},n,{onClick:this.onClick}),t)},t}(r.Component);var ve=n(85961),he=n(58571),ye=n(11572),ge=n(77715),be=n(26464),Ee=n(32878),_e=n(62289),ke=n(94912),Oe=[{title:"IsParent",relationship:T.NeigbhorIsParent},{title:"IsAChild",relationship:T.NeigbhorIsAChild},{title:"IsASibling",relationship:T.NeigbhorIsASibling},{title:"NoneOfTheAbove",relationship:T.NoneOfTheAbove}];const Ne=function(){return r.createElement("div",{className:"d-flex align-items-center"},r.createElement("strong",null,"Loading, please wait."),r.createElement("div",{className:"spinner-border me-2",role:"status"},r.createElement("span",{className:"sr-only"},"Loading...")))};var we=n(25325),Ce=n.n(we),Se=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,l=o.length;i<l;i++,a++)r[a]=o[i];return r},je=function(e,t){var n=e.offset,r=e.s,a=e.t,o=e.accessor;return n*t(function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}(r,a))+r[o]},Pe=[T.NeigbhorIsAChild,T.NeigbhorIsParent],Ae=function(e){return"Router2Router"===e.linkType?1:Pe.includes(e.relationship)?.5:0},Re={BrokenLink:450,Router2Router:200,Coordinator2Router:200,Coordinator2EndDevice:50,EndDevice2Router:50},Ie=function(e){var t;return null!==(t=Re[e.linkType])&&void 0!==t?t:200},De=function(e){var t=e.transform,n=e.node,r=e.link,a=e.linkLabel;e.links.forEach((function(e){var n=t.apply([e.source.x,e.source.y]),r=n[0],a=n[1],o=t.apply([e.target.x,e.target.y]),i=o[0],l=(o[1]-a)/(i-r);e.x=(i+r)/2,e.y=(i-r)*l/2+a})),r.attr("d",(function(e){return function(e,t){var n=e.source,r=e.target,a=t.apply([n.x,n.y]),o=a[0],i=a[1],l=t.apply([r.x,r.y]);return"M "+o+" "+i+" L "+l[0]+" "+l[1]}(e,t)})),a.attr("x",(function(e){return t.applyX((100,n=e.source,r=e.target,je({offset:100,s:n,t:r,accessor:"x"},Math.cos)));var n,r})).attr("y",(function(e){return t.applyY((100,n=e.source,r=e.target,je({offset:100,s:n,t:r,accessor:"y"},Math.sin)));var n,r})),n.attr("transform",(function(e){var n=t.apply([e.x,e.y]);return"translate("+(n[0]-16)+", "+(n[1]-16)+")"}))},Te=function(e){var t=e.networkGraph,n=e.links,r=e.selectedNode,a=e.node,o=e.link,i=e.linkLabel,l=new Set;t.nodes.forEach((function(e){return l.add(e.ieeeAddr+","+e.ieeeAddr)})),n.forEach((function(e){return l.add(e.sourceIeeeAddr+","+e.targetIeeeAddr)}));var c=function(e,t){return l.has(e.ieeeAddr+","+t.ieeeAddr)},s=function(e){return e.source===r||e.target===r?1:.15};r?(a.style("opacity",(function(e){return c(r,e)||c(e,r)?1:.15})),o.style("stroke-opacity",s),i.style("opacity",s)):(a.style("opacity",1),o.style("stroke-opacity",1),i.style("opacity",1))},Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=(0,r.createRef)(),t.svgRef=(0,r.createRef)(),t.simulation=(0,ve.Z)(),t.state={width:0,height:0,visibleLinks:Pe,legendIsVisible:!0},t.transform=ke.CR,t.updateNodes=function(){var e,n=t.props.networkGraph;if(n.nodes.length){var r=t.state,o=r.visibleLinks,i=r.selectedNode,c=r.width,s=r.height,u=(0,l.Z)(t.svgRef.current),p=u.selectAll("."+a.node),m=u.selectAll("."+a.link),d=u.selectAll("."+a.linkLabel),f=n.links.filter((function(e){return Ce()(o,e.relationships).length}));t.simulation.nodes(n.nodes.concat(f)),null===(e=t.simulation.force("link"))||void 0===e||e.links(f),t.simulation.on("tick",(function(){return De({transform:t.transform,node:p,link:m,linkLabel:d,links:f})}));var v=u.selectAll(".everything");(0,ke.sP)().extent([[0,0],[c,s]]).scaleExtent([.1,8]).on("zoom",(function(e){var t=e.transform;v.attr("transform",t)}))(u),Te({networkGraph:n,links:f,selectedNode:i,node:p,link:m,linkLabel:d}),p.on("click",(function(e,n){var r=t.state.selectedNode;t.setState({selectedNode:r?null:n})})),t.simulation.alphaTarget(.03).restart()}},t.onRequestClick=function(){(0,t.props.networkMapRequest)()},t.onLinkTypeFilterChange=function(e){var n=t.state.visibleLinks,r=e.target,a=r.checked,o=r.value,i=parseInt(o,10),l=xe(n);a?l.push(i):l=l.filter((function(e){return e!==i})),t.setState({visibleLinks:l})},t}return Se(t,e),t.prototype.updateForces=function(e,t){this.simulation=this.simulation.force("link",(0,he.Z)().id((function(e){return e.ieeeAddr})).distance(Ie).strength(Ae)).force("charge",(0,_e.Z)().strength(-700)).force("collisionForce",(0,ye.Z)()).force("center",(0,ge.Z)(e/2,t/2)).force("x",(0,be.Z)().strength(.1)).force("y",(0,Ee.Z)().strength(.2))},t.prototype.initPage=function(){var e=this.ref.current.getBoundingClientRect(),t=e.width,n=e.height;this.setState({width:t,height:n}),this.updateForces(t,n)},t.prototype.componentDidMount=function(){this.initPage()},t.prototype.componentDidUpdate=function(){this.updateNodes()},t.prototype.renderMap=function(){var e=this.state,t=e.width,n=e.height,a=e.visibleLinks,o=this.props.networkGraph,i=o.links.filter((function(e){return Ce()(a,e.relationships).length>0}));return r.createElement("svg",{ref:this.svgRef,viewBox:"0 0 "+t+" "+n},r.createElement("g",{className:"everything"},r.createElement(p,{links:i}),r.createElement(D,{root:this.svgRef.current,nodes:o.nodes,simulation:this.simulation})))},t.prototype.renderMessage=function(){var e=this.props.networkGraphIsLoading;return r.createElement("div",{className:"h-100 d-flex justify-content-center align-items-center"},e?r.createElement("div",null,r.createElement(Ne,null),r.createElement("div",null,"Depending on the size of your network this can take somewhere between 10 seconds and 2 minutes.")):r.createElement(fe,{onClick:this.onRequestClick,className:"btn btn-primary d-block"},"Load map"))},t.prototype.renderMapControls=function(){var e=this,t=this.state.visibleLinks;return r.createElement("div",{className:a.controls},Oe.map((function(n){return r.createElement("div",{key:n.title,className:"form-check form-check-inline"},r.createElement("input",{onChange:e.onLinkTypeFilterChange,className:"form-check-input",type:"checkbox",id:n.title,value:n.relationship,checked:t.includes(n.relationship)}),r.createElement("label",{className:"form-check-label",htmlFor:n.title},n.title))})),r.createElement("div",{className:"btn-group btn-group-sm",role:"group"},r.createElement(fe,{title:"Refresh data",className:"btn btn-primary",onClick:this.onRequestClick},r.createElement("i",{className:"fa fa-sync"}))))},t.prototype.render=function(){var e=this,t=this.props.networkGraph,n=this.state.legendIsVisible;return r.createElement("div",{className:a.container,ref:this.ref},t.nodes.length?r.createElement(r.Fragment,null,this.renderMapControls()," ",this.renderMap()):this.renderMessage(),r.createElement("div",{className:i()("fixed-bottom",{"d-none":!n}),onClick:function(){return e.setState({legendIsVisible:!1})}},r.createElement("div",{className:i()(a.node,a.Coordinator)},r.createElement("svg",{width:"28",height:"28",viewBox:"0 0 28 28"},r.createElement("polygon",{points:R(5,5,14)}))," is Coordinator"),r.createElement("div",{className:i()(a.node,a.EndDevice)},"Green means End Device"),r.createElement("div",{className:i()(a.node,a.Router)},"Blue means Router"),r.createElement("div",null,"Solid lines are the link to the ",r.createElement("span",{className:i()(a.node,a.Coordinator)},"Coordinator")),r.createElement("div",null,"Dashed lines are the link with ",r.createElement("span",{className:i()(a.node,a.Coordinator)},"Router")),r.createElement("div",null,"Link quality is between 0 - 255, values with / represents multiple types of links"),r.createElement("div",null,"Click on me to hide")))},t}(r.Component);const Fe=(0,F.$)(["networkGraph","networkGraphIsLoading"],pe)(Me);var Le=n(73727),qe=n(5977),Ge=n(73935),Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(e){return r.createElement("div",{className:"modal-header"},e.children)},We=function(e){return r.createElement("div",{className:"modal-body"},e.children)},Ze=function(e){return r.createElement("div",{className:"modal-footer"},e.children)},He=function(e){function t(t){var n=e.call(this,t)||this;return n.el=document.createElement("div"),"modal-backdrop fade show".split(" ").map((function(e){return n.el.classList.add(e)})),n}return Be(t,e),t.prototype.componentDidMount=function(){document.body.appendChild(this.el)},t.prototype.componentWillUnmount=function(){document.body.removeChild(this.el)},t.prototype.render=function(){return Ge.createPortal(this.props.children,this.el)},t}(r.Component);const Ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openModal=function(){document.body.classList.add("modal-open")},t.closeModal=function(){document.body.classList.remove("modal-open")},t}return Be(t,e),t.prototype.componentDidMount=function(){this.props.isOpen?this.openModal():this.closeModal()},t.prototype.componentDidUpdate=function(e){e.isOpen!==this.props.isOpen&&(this.props.isOpen?this.openModal():this.closeModal())},t.prototype.render=function(){return this.props.isOpen&&r.createElement("div",{className:"modal fade show",style:{display:"block"}},r.createElement("div",{className:"modal-dialog"},r.createElement("div",{className:"modal-content"},this.props.children)),r.createElement(He,null))},t}(r.Component);var ze=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Je=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},Qe=function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isRenameModalOpened:!1,isDeviceRemovalModalOpened:!1,renameParams:{friendlyName:t.props.device.friendly_name,isHassRename:!1},removeParams:{block:!1,force:!1}},t.onRenameClick=function(){return Je(t,void 0,void 0,(function(){var e,t,n,r;return Qe(this,(function(a){switch(a.label){case 0:return e=this.props,t=e.renameDevice,n=e.device,r=this.state.renameParams,[4,t(n.friendly_name,r.friendlyName,r.isHassRename)];case 1:return a.sent(),this.setState({isRenameModalOpened:!1}),[2]}}))}))},t.onRemoveClick=function(){var e=t.props,n=e.removeDevice,r=e.device,a=t.state.removeParams;n(r.friendly_name,a.force,a.block),t.setState({isDeviceRemovalModalOpened:!1})},t.toggleRenameModal=function(){var e=t.state.isRenameModalOpened;t.setState({isRenameModalOpened:!e})},t.toggleDeviceRemovalModal=function(){var e=t.state.isDeviceRemovalModalOpened;t.setState({isDeviceRemovalModalOpened:!e})},t.onHassEntityIdChange=function(e){var n=t.state.renameParams,r=e.target.checked;n.isHassRename=r,t.setState({renameParams:n})},t.onFriendlyNameChange=function(e){var n=t.state.renameParams,r=e.target.value;n.friendlyName=r,t.setState({renameParams:n})},t.onDeviceRemovalParamChange=function(e){var n=t.state.removeParams,r=e.target,a=r.checked;n[r.name]=a,t.setState({removeParams:n})},t}return ze(t,e),t.prototype.renderRenameButton=function(){var e,t=this.props,n=t.bridgeInfo,a=t.device,o=this.state,i=o.isRenameModalOpened,l=o.renameParams;return r.createElement(r.Fragment,null,r.createElement(fe,{className:"btn btn-primary",onClick:this.toggleRenameModal,title:"Rename device"},r.createElement("i",{className:"fa fa-edit"})),r.createElement(Ve,{isOpen:i},r.createElement(Ue,null,r.createElement("h3",null,"Rename device"),r.createElement("small",null,a.friendly_name)),r.createElement(We,null,r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"fn"+a.ieee_address,className:"form-label"},"Friendly name"),r.createElement("input",{id:"fn"+a.ieee_address,onChange:this.onFriendlyNameChange,type:"text",className:"form-control",value:l.friendlyName})),(null===(e=null==n?void 0:n.config)||void 0===e?void 0:e.homeassistant)?r.createElement("div",{className:"form-check form-switch"},r.createElement("input",{className:"form-check-input",checked:l.isHassRename,type:"checkbox",id:"hass"+a.ieee_address,onChange:this.onHassEntityIdChange}),r.createElement("label",{className:"form-check-label",htmlFor:"hass"+a.ieee_address},"Update Home Assistant entity ID")):null),r.createElement(Ze,null,r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.toggleRenameModal},"Close"),r.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.onRenameClick},"Save changes"))))},t.prototype.renderDeviceRemovalButton=function(){var e=this,t=this.props.device,n=this.state,a=n.isDeviceRemovalModalOpened,o=n.removeParams,l=[{label:"Force remove",name:"force",value:o.force},{label:"Block from joining again",name:"block",value:o.block}];return r.createElement(r.Fragment,null,r.createElement(Ve,{isOpen:a},r.createElement(Ue,null,r.createElement("h3",null,"Remove device"),r.createElement("small",null,t.friendly_name)),r.createElement(We,null,l.map((function(n){var a=""+n.name+t.ieee_address;return r.createElement("div",{key:n.name,className:"form-check form-switch"},r.createElement("input",{className:"form-check-input",name:n.name,checked:n.value,type:"checkbox",id:a,onChange:e.onDeviceRemovalParamChange}),r.createElement("label",{className:"form-check-label",htmlFor:a},n.label))}))),r.createElement(Ze,null,r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.toggleDeviceRemovalModal},"Close"),r.createElement("button",{type:"button",className:"btn btn-danger",onClick:this.onRemoveClick},"Delete"))),r.createElement("button",{onClick:this.toggleDeviceRemovalModal,className:"btn btn-danger",title:"Remove device"},r.createElement("i",{className:i()("fa","fa-trash")})))},t.prototype.render=function(){var e=this.props,t=e.device,n=e.configureDevice;return r.createElement("div",{className:"btn-group btn-group-sm",role:"group"},this.renderRenameButton(),r.createElement(fe,{className:"btn btn-warning",onClick:n,item:t.friendly_name,title:"Reconfigure",promt:!0},r.createElement("i",{className:i()("fa","fa-retweet")})),this.renderDeviceRemovalButton())},t}(r.Component);const Ke=(0,F.$)(["bridgeInfo"],pe)($e);var Ye=n(27361),Xe=n.n(Ye),et=function(e){var t=new RegExp("[/| |:]","g");return e.replace(t,"_")},tt=function(e){var t,n=e.device;if(n.supported&&n.definition){var a="https://www.zigbee2mqtt.io/information/supported_devices.html#"+encodeURIComponent(et(null===(t=n.definition.vendor)||void 0===t?void 0:t.toLowerCase()));return r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:a},n.definition.vendor)}return r.createElement(r.Fragment,null,"Unsupported")},nt=function(e){var t,n,a,o,i,l=e.device,c="https://www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html#how-to-support-new-devices",s=l.model_id;if(l.supported&&l.definition){var u=[encodeURIComponent(null===(n=null===(t=l.definition)||void 0===t?void 0:t.vendor)||void 0===n?void 0:n.toLowerCase()),encodeURIComponent(null===(o=null===(a=l.definition)||void 0===a?void 0:a.model)||void 0===o?void 0:o.toLowerCase())].join("-");c="https://www.zigbee2mqtt.io/devices/"+encodeURIComponent(et(null===(i=l.definition)||void 0===i?void 0:i.model))+".html#"+encodeURIComponent(et(u)),s=l.definition.model}return r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:c},s)};var rt=function(){return(rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const at=function(e){var t=e.source,n=e.battery,a=e.batteryLow,o=e.showLevel,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["source","battery","batteryLow","showLevel"]),l="",c="";switch(t){case"Battery":if(c="Battery",void 0!==a&&(l=a?"fa-battery-empty animation-blinking text-danger":"fa-battery-full text-success",c+=a?" LOW":" OK"),void 0!==n)if(n>=85)l+=" fa-battery-full";else if(n>=75)l+=" fa-battery-three-quarters";else if(n>=50)l+=" fa-battery-half";else if(n>=25)l+=" fa-battery-quarter";else{if(!(n>=10))return r.createElement("span",{className:"animation-blinking text-danger",role:"alert"},n,"%");l+=" fa-battery-empty animation-blinking"}return c+=n?", power level "+n+"%":"",l||(l="fa-question"),r.createElement(r.Fragment,null,o?r.createElement("span",{className:"pe-2"},"Battery ",void 0!==n?n+"%":null):null,r.createElement("i",rt({className:"fa "+l,title:c},i)));case"Mains (single phase)":case"DC Source":return r.createElement("i",rt({className:"fa fa-plug _2Qj8QVth6tVVFe6VESug0N",title:t},i));default:return r.createElement("i",rt({className:"fa fa-question",title:t},i))}};var ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=/\[(.*?)\]\((.*?)\)/,lt=[{label:"Friendly name",render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},r.createElement("strong",null,e.friendly_name))}},{key:"type",label:"Device type"},{key:"model_id",label:"Zigbee model"},{key:"definition.description",label:"Description",if:"supported",render:function(e){var t,n,a=it.exec(null===(t=e.definition)||void 0===t?void 0:t.description),o=r.createElement("span",null,null===(n=e.definition)||void 0===n?void 0:n.description);if(a){a[0];var i=a[1],l=a[2];o=r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:l},i)}return r.createElement("dd",{className:"col-12 col-md-7"},o)}},{render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},r.createElement("p",{className:i()("mb-0","font-weight-bold",{"text-danger":!e.supported,"text-success":e.supported})},e.supported?"Supported":"Unsupported"))},label:"Support status"},{render:function(e){var t;return r.createElement("dd",{className:"col-12 col-md-7"},null===(t=e.definition)||void 0===t?void 0:t.supports)},label:"Supports",if:"definition.supports"},{key:"ieee_address",label:"IEEE address"},{key:"network_address",label:"Network address",render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},h(e.network_address))}},{key:"date_code",label:"Firmware build date",if:"date_code"},{key:"software_build_id",label:"Firmware version",if:"software_build_id"},{key:"definition.vendor",label:"Vendor",if:"supported",render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},r.createElement(tt,{device:e}))}},{key:"definition.model",label:"Model",if:"supported",render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},r.createElement(nt,{device:e}))}},{label:"Power source",render:function(e,t){return r.createElement("dd",{className:"col-12 col-md-7"},r.createElement(at,{showLevel:!0,source:e.power_source,battery:t.battery,batteryLow:t.battery_low}))}},{label:"Interview completed",render:function(e){return r.createElement("dd",{className:"col-12 col-md-7"},e.interview_completed?"Yes":"No")}}],ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ot(t,e),t.prototype.render=function(){var e,t=this.props,n=t.device,a=null!==(e=t.deviceStates.get(n.friendly_name))&&void 0!==e?e:{};return r.createElement(r.Fragment,null,r.createElement("div",{className:"d-flex justify-content-center"},r.createElement(x,{className:"card-img-top w-auto _2UWt6cv5iKbBWQ1njU-Knh",device:n,deviceStatus:a})),r.createElement("dl",{className:"row"},lt.filter((function(e){return void 0===e.if||Xe()(n,e.if,!1)})).map((function(e){return r.createElement(r.Fragment,{key:e.label},r.createElement("dt",{className:"col-12 col-md-5"},e.label),e.render?e.render(n,a):r.createElement("dd",{className:"col-12 col-md-7"},Xe()(n,e.key)))}))),r.createElement(Ke,{device:n,state:a}))},t}(r.Component);const st=(0,F.$)(["deviceStates"])(ct);var ut=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pt=function(){return(pt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e){var n=t.props,r=n.onChange,a=n.devices,o=n.groups,i=void 0===o?[]:o,l=e.target.value;a.has(l)?r(a.get(l),"device"):r(i.find((function(e){return parseInt(l,10)===e.id})),"group")},t}return ut(t,e),t.prototype.render=function(){var e=this.props,t=e.devices,n=e.groups,a=e.value,o=(e.type,e.label),i=(e.onChange,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["devices","groups","value","type","label","onChange"])),l=[r.createElement("option",{key:"hidden",hidden:!0},"Select device")],c=[];if(t.forEach((function(e){var t;c.push(r.createElement("option",{title:null===(t=e.definition)||void 0===t?void 0:t.description,key:e.ieee_address,value:e.ieee_address},function(e){var t,n;return e.friendly_name+" "+((null===(t=e.definition)||void 0===t?void 0:t.model)?"("+(null===(n=e.definition)||void 0===n?void 0:n.model)+")":"")}(e)))})),n&&n.length){var s=n.map((function(e){return r.createElement("option",{key:e.friendly_name,value:e.id},e.friendly_name)}));l.push(r.createElement("optgroup",{key:"Groups",label:"Groups"},s)),l.push(r.createElement("optgroup",{key:"Devices",label:"Devices"},c))}else l=l.concat(c);return r.createElement("div",{className:"form-group"},o&&r.createElement("label",{className:"form-label"},o),r.createElement("select",pt({value:a,onChange:this.onSelect,className:"form-control"},i),l))},t}(r.Component);var dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(){return(ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e){(0,t.props.onChange)(e.target.value)},t}return dt(t,e),t.prototype.render=function(){var e=this.props,t=(e.onSelect,e.value),n=e.values,a=e.disabled,o=(e.onChange,e.label),i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["onSelect","value","values","disabled","onChange","label"]),l=1==n.length,c=n.map((function(e){return r.createElement("option",{key:e,value:e},e)}));return c.unshift(r.createElement("option",{key:"hidded",hidden:!0},"Select endpoint")),r.createElement("div",{className:"form-group"},o&&r.createElement("label",{className:"form-label"},o),r.createElement("select",ft({disabled:t&&l||a,value:t,className:"form-control",title:l?"The only endpoint":"",onChange:this.onSelect},i),c))},t}(r.Component);var ht,yt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(){return(gt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},bt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},Et={genPowerCfg:"PowerCfg",genScenes:"Scenes",genOnOff:"OnOff",genLevelCtrl:"LevelCtrl",lightingColorCtrl:"LColorCtrl",closuresWindowCovering:"Closures",genMultistateInput:"MultistateInput",genGroups:"Groups",genOta:"Ota",touchlink:"Touchlink",genIdentify:"Identify",msTemperatureMeasurement:"Temperature",msIlluminanceMeasurement:"Illuminance",msRelativeHumidity:"Humidity",msPressureMeasurement:"Pressure",msSoilMoisture:"Soil Moisture"};function _t(e){return e.length>0&&"string"!=typeof e[0]}!function(e){e[e.MULTIPLE=0]="MULTIPLE",e[e.SINGLE=1]="SINGLE"}(ht||(ht={}));const kt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={pickerId:b(5)},t.onChange=function(e){var n=t.props,r=n.onChange,a=n.pickerType,o=t.props.value,i=e.target.name;a===ht.MULTIPLE?e.target.checked?o.push(i):o=o.filter((function(e){return e!==i})):o=e.target.value,r(o)},t}return yt(t,e),t.prototype.render=function(){return this.props.pickerType===ht.MULTIPLE?this.renderMultiPicker():this.renderSinglePicker()},t.prototype.renderMultiPicker=function(){var e=this,t=this.state.pickerId,n=this.props,a=n.clusters,o=void 0===a?[]:a,i=n.value,l=(n.pickerType,n.onChange,n.label),c=bt(n,["clusters","value","pickerType","onChange","label"]),s=[];return _t(o)?console.warn("Not implemented"):s=o.map((function(n){var a;return r.createElement("div",{key:n,className:"form-check form-check-inline"},r.createElement("input",gt({className:"form-check-input",type:"checkbox",checked:i.includes(n),name:n,id:t+"_"+n,value:n,onChange:e.onChange},c)),r.createElement("label",{className:"form-check-label",htmlFor:t+"_"+n,title:n},null!==(a=Et[n])&&void 0!==a?a:n))})),r.createElement("div",{className:"form-group"},l&&r.createElement("label",{className:"form-label"},l),r.createElement("div",{className:"form-control border-0"},s))},t.prototype.renderSinglePicker=function(){var e=this.props,t=e.clusters,n=void 0===t?[]:t,a=(e.onChange,e.pickerType,e.label),o=bt(e,["clusters","onChange","pickerType","label"]),i=[r.createElement("option",{key:"hidden",hidden:!0},"Select cluster")];return _t(n)?n.forEach((function(e){var t=e.clusters.map((function(e){var t;return r.createElement("option",{key:e,value:e},null!==(t=Et[e])&&void 0!==t?t:e)}));0===t.length&&t.push(r.createElement("option",{key:"none",disabled:!0},"None")),i.push(r.createElement("optgroup",{key:e.name,label:e.name},t))})):n.forEach((function(e){var t;i.push(r.createElement("option",{key:e,value:e},null!==(t=Et[e])&&void 0!==t?t:e))})),r.createElement("div",{className:"form-group"},a&&r.createElement("label",{className:"form-label"},a),r.createElement("select",gt({className:"form-select",onChange:this.onChange},o),i))},t}(r.Component);var Ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={stateRule:{}},t.setSourceEp=function(e){var n=t.state.stateRule;n.source.endpoint=e,t.setState({stateRule:n})},t.setDestination=function(e,n){var r=t.state.stateRule;if("device"===n){var a=O(e);r.target.ieee_address=e.ieee_address,r.target.type="endpoint",r.target.endpoint=a[0],delete r.target.id}else"group"===n&&(r.target.id=e.id,r.target.type="group",delete r.target.ieee_address);r.clusters=[],t.setState({stateRule:r})},t.setDestinationEp=function(e){var n=t.state.stateRule;n.target.endpoint=e,n.clusters=[],t.setState({stateRule:n})},t.setClusters=function(e){var n=t.state.stateRule;n.clusters=e,t.setState({stateRule:n})},t.onBindOrUnBindClick=function(e){var n=t.props,r=n.onUnBind,a=n.onBind,o=t.getBidningParams(),i=o.from,l=o.to,c=o.clusters;"Bind"==e?a({from:i,to:l,clusters:c}):r({from:i,to:l,clusters:c})},t}return Ot(t,e),t.getDerivedStateFromProps=function(e,t){return{stateRule:e.rule}},t.prototype.getBidningParams=function(){var e,t=this.props,n=t.device,r=t.groups,a=t.devices,o=this.state.stateRule,i=n.friendly_name+"/"+o.source.endpoint,l="";if("group"===o.target.type)l=""+r.find((function(e){return e.id===o.target.id})).friendly_name;else if("endpoint"===o.target.type){var c=a.get(null===(e=o.target)||void 0===e?void 0:e.ieee_address);l="Coordinator"===c.type?""+c.friendly_name:c.friendly_name+"/"+o.target.endpoint}return{from:i,to:l,clusters:o.clusters}},t.prototype.isValidRule=function(){var e,t=this.state.stateRule;return"endpoint"==t.target.type?e=t.source.endpoint&&t.target.ieee_address&&t.target.endpoint&&t.clusters.length>0:"group"==t.target.type&&(e=t.source.endpoint&&t.target.id&&t.clusters.length>0),!!e},t.prototype.render=function(){var e=this.props,t=e.devices,n=e.groups,a=(e.idx,e.device),o=this.state.stateRule,i="endpoint"===o.target.type?"device":"group",l=O(a),c=function(e,t,n){var r;return"group"===e.target.type?n.find((function(t){return t.id===e.target.id})):t.get(null===(r=e.target)||void 0===r?void 0:r.ieee_address)}(o,t,n),s=O(c),u=new Set(o.clusters),p=a.endpoints.get(o.source.endpoint);return p&&p.clusters.output.forEach((function(e){return u.add(e)})),r.createElement("div",{className:"row pb-2 border-bottom"},r.createElement("div",{className:"col-md-2"},r.createElement(vt,{label:"Source EP",disabled:!o.isNew,values:l,value:o.source.endpoint,onChange:this.setSourceEp})),r.createElement("div",{className:"col-md-2"},r.createElement(mt,{label:"Destination",disabled:!o.isNew,type:i,value:o.target.ieee_address||o.target.id,devices:t,groups:n,onChange:this.setDestination})),r.createElement("div",{className:"col-md-2"},"endpoint"===o.target.type?r.createElement(vt,{label:"Destination EP",disabled:!o.isNew,values:s,value:o.target.endpoint,onChange:this.setDestinationEp}):null),r.createElement("div",{className:"col-md-4"},r.createElement(kt,{label:"Clusters",pickerType:ht.MULTIPLE,clusters:Array.from(u),value:o.clusters,onChange:this.setClusters})),r.createElement("div",{className:"col-md-2"},r.createElement("div",{className:"form-group"},r.createElement("label",{className:"form-label"},"Actions"),r.createElement("div",{className:"form-control border-0"},r.createElement("div",{className:"btn-group btn-group-sm"},r.createElement(fe,{item:"Bind",disabled:!this.isValidRule(),title:"Bind",className:"btn btn-primary",onClick:this.onBindOrUnBindClick},"Bind",r.createElement("i",{className:"fa fa-heart"})),r.createElement(fe,{item:"Unbind",disabled:!o.isNew&&!this.isValidRule(),title:"Unbind",className:"btn btn-danger",onClick:this.onBindOrUnBindClick},r.createElement("i",{className:"fa fa-heart-broken"}),"Unbind"))))))},t}(r.Component);var wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=function(e){return e.source.endpoint+"-"+e.isNew+e.source.ieee_address+"-"+e.target.id+"-"+e.target.ieee_address+"-"+e.clusters.join("-")},St=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={bidingRules:[]},t}return wt(t,e),t.getDerivedStateFromProps=function(e){var t=e.device,n=O(t),r=function(e){var t={};return e.endpoints.forEach((function(n,r){n.bindings.forEach((function(n){var a,o=null!==(a=n.target.id)&&void 0!==a?a:n.target.ieee_address+"-"+n.target.endpoint;t[o=o+"-"+r]?t[o].clusters.push(n.cluster):t[o]={source:{ieee_address:e.ieee_address,endpoint:r},target:n.target,clusters:[n.cluster]}}))})),Object.values(t)}(t);return r.push({isNew:Date.now(),target:{},source:{ieee_address:t.ieee_address,endpoint:n[0]},clusters:[]}),{bidingRules:r}},t.prototype.renderBody=function(){var e=this.props,t=e.device,n=e.devices,a=e.groups,o=e.removeBind,i=e.addBind;return this.state.bidingRules.map((function(e,l){return r.createElement(Nt,{key:Ct(e),rule:e,groups:a,onUnBind:o,onBind:i,device:t,idx:l,devices:n})}))},t.prototype.render=function(){return r.createElement("div",{className:"container-fluid"},this.renderBody())},t}(r.Component);const xt=(0,F.$)(["devices","groups"],pe)(St);var jt=n(73056),Pt=n.n(jt),At=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const It=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){(0,t.props.onChange)(e.target.value)},t}return At(t,e),t.prototype.render=function(){var e=this.props,t=e.cluster,n=(e.onChange,e.label),a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["cluster","onChange","label"]),o=[],i=Pt()[t];i&&(o=Object.keys(i.attributes));var l=o.map((function(e){return r.createElement("option",{key:e,value:e},e)}));return l.unshift(r.createElement("option",{key:"none",hidden:!0},"Select attribute")),r.createElement("div",{className:"form-group"},n&&r.createElement("label",{className:"form-label"},n),r.createElement("select",Rt({disabled:0===o.length,className:"form-control",onChange:this.onChange},a),l))},t}(r.Component);var Dt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(){return(Tt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Mt=function(e,t){var n=Object.keys(Pt()),r=[],a=e.endpoints.get(t);return a&&(r=r.concat(a.clusters.output),n=n.filter((function(e){return!r.includes(e)}))),[{name:"Avaliable",clusters:r},{name:"Possible",clusters:n}]},Ft=["maximum_report_interval","minimum_report_interval","reportable_change","endpoint","cluster","attribute"],Lt=function(e){return Ft.every((function(t){return void 0!==e[t]}))};const qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={stateRule:{}},t.setSourceEp=function(e){var n=t.state.stateRule;n.endpoint=e,t.setState({stateRule:n})},t.setCluster=function(e){var n=t.state.stateRule;n.cluster=e,t.setState({stateRule:n})},t.setAttribute=function(e){var n=t.state.stateRule;n.attribute=e,t.setState({stateRule:n})},t.changeHandler=function(e){var n=t.state.stateRule,r=e.target,a=r.name,o=r.value;n[a]=o,t.setState({stateRule:n})},t.applyRule=function(){(0,t.props.onApply)(t.state.stateRule)},t.disableRule=function(){var e=t.props.onApply,n=t.state.stateRule;e(Tt(Tt({},n),{maximum_report_interval:65535}))},t}return Dt(t,e),t.getDerivedStateFromProps=function(e,t){return{stateRule:e.rule}},t.prototype.render=function(){var e=this.props,t=e.rule,n=e.device,a=this.state.stateRule,o=O(n);return r.createElement("div",{className:"row pb-2 border-bottom"},r.createElement("div",{className:"col-md-2"},r.createElement(vt,{label:"Endpoint",disabled:!t.isNew,values:o,value:a.endpoint,onChange:this.setSourceEp})),r.createElement("div",{className:"col-md-2"},r.createElement(kt,{label:"Cluster",disabled:!a.endpoint,pickerType:ht.SINGLE,clusters:Mt(n,a.endpoint),value:a.cluster,onChange:this.setCluster})),r.createElement("div",{className:"col-md-2"},r.createElement(It,{label:"Attribute",value:a.attribute,cluster:a.cluster,onChange:this.setAttribute})),r.createElement("div",{className:"col-md-2"},r.createElement("div",{className:"form-group"},r.createElement("label",{className:"form-label"},"Min rep interval"),r.createElement("input",{onChange:this.changeHandler,value:a.minimum_report_interval,required:!0,type:"number",name:"minimum_report_interval",className:"form-control"}))),r.createElement("div",{className:"col-md-1"},r.createElement("div",{className:"form-group"},r.createElement("label",{className:"form-label"},"Max rep interval"),r.createElement("input",{onChange:this.changeHandler,value:a.maximum_report_interval,required:!0,type:"number",name:"maximum_report_interval",className:"form-control"}))),r.createElement("div",{className:"col-md-1"},r.createElement("div",{className:"form-group"},r.createElement("label",{className:"form-label"},"Min rep change"),r.createElement("input",{placeholder:"Enter 65535 to disable reporting",onChange:this.changeHandler,value:a.reportable_change,required:!0,type:"number",name:"reportable_change",className:"form-control"}))),r.createElement("div",{className:"col-md-2"},r.createElement("div",{className:"form-group"},r.createElement("label",{className:"form-label"},"Actions"),r.createElement("div",{className:"form-group"},r.createElement("div",{className:"btn-group",role:"group","aria-label":"Basic example"},r.createElement(fe,{disabled:!Lt(a),className:"btn btn-primary",onClick:this.applyRule},"Apply"),a.isNew?null:r.createElement(fe,{promt:!0,className:"btn btn-danger",onClick:this.disableRule},"Disable"))))))},t}(r.Component);var Gt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bt=function(){return(Bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ut=function(e){return""+e.isNew+e.endpoint+e.cluster+"-"+e.attribute},Wt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={reportingRules:[]},t.onApply=function(e){var n=t.props,r=n.configureReport,a=n.device,o=e.cluster,i=e.endpoint,l=e.attribute,c=e.minimum_report_interval,s=e.maximum_report_interval,u=e.reportable_change;r(a.friendly_name+"/"+i,{cluster:o,attribute:l,minimum_report_interval:c,maximum_report_interval:s,reportable_change:u})},t}return Gt(t,e),t.getDerivedStateFromProps=function(e){var t,n,r=(t=e.device,n=[],t.endpoints.forEach((function(e,t){e.configured_reportings.forEach((function(e){n.push(Bt(Bt({},e),{endpoint:t}))}))})),n);return r.push({isNew:Date.now(),reportable_change:0,minimum_report_interval:60,maximum_report_interval:3600}),{reportingRules:r}},t.prototype.render=function(){var e=this,t=this.props.device,n=this.state.reportingRules;return r.createElement("div",{className:"container-fluid"},n.map((function(n){return r.createElement(qt,{key:Ut(n),rule:n,device:t,onApply:e.onApply})})))},t}(r.Component);const Zt=(0,F.$)(["devices","groups"],pe)(Wt);var Ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setStateValue=function(e,n){var r=t.props;(0,r.setStateValue)(r.device.friendly_name,e,n)},t}return Ht(t,e),t.prototype.render=function(){var e,t=this.props,n=t.device,a=null!==(e=t.deviceStates.get(n.friendly_name))&&void 0!==e?e:{};return r.createElement("pre",null,JSON.stringify(a,null,4))},t}(r.Component);const zt=(0,F.$)(["deviceStates"],pe)(Vt);function Jt(e){return"light"===e.type}function Qt(e){return"composite"===e.type&&"color_xy"!==e.name&&"color_hs"!==e.name}var $t,Kt=n(7739),Yt=n.n(Kt);!function(e){e[e.NONE=0]="NONE",e[e.ACCESS_STATE=1]="ACCESS_STATE",e[e.ACCESS_WRITE=2]="ACCESS_WRITE",e[e.ACCESS_READ=4]="ACCESS_READ"}($t||($t={}));var Xt={contact:new Map([[!0,"Closed"],[!1,"Open"]]),occupancy:new Map([[!0,"Occupied"],[!1,"Clear"]]),water_leak:new Map([[!0,r.createElement("span",{className:i()("text-danger","animation-blinking"),key:"Leaking"},"Leaking")],[!1,"Clear"]]),tamper:new Map([[!0,r.createElement("span",{className:i()("text-danger","animation-blinking"),key:"tampered"},"Tampered")],[!1,"Clear"]]),_default:new Map([[!0,"true"],[!1,"false"]])};function en(e){var t=e.value,n=e.name;switch(typeof t){case"boolean":var a=Xt[n]||Xt._default;return r.createElement(r.Fragment,null,a.get(t));case"undefined":return r.createElement(r.Fragment,null,"N/A");case"object":return r.createElement(r.Fragment,null,null===t?"null":JSON.stringify(t));case"string":return r.createElement(r.Fragment,null,""===t?r.createElement("small",{className:"text-muted"},"empty string"):t);default:return r.createElement(r.Fragment,null,JSON.stringify(t))}}var tn=function(e){var t=e.value,n=e.onClick,a=e.name;return r.createElement(fe,{className:"btn btn-link",item:t,onClick:n},r.createElement(en,{value:t,name:a}))};const nn=function(e){var t=e.onChange,n=e.value,a=e.valueOn,o=e.valueOff,i=e.minimal,l=e.name,c=null!=n,s=!i||i&&!c;return r.createElement("div",null,s&&r.createElement(tn,{value:o,name:l,onClick:t}),c?r.createElement("div",{className:"form-check form-switch form-check-inline align-middle me-0"},r.createElement("input",{className:"form-check-input",type:"checkbox",checked:n===a,onChange:function(e){return t(e.target.checked?a:o)}})):r.createElement("i",{className:"fa fa-question",title:"Current value unknown"}),s&&r.createElement(tn,{value:a,name:l,onClick:t}))};var rn=function(e){var t=e.feature,n=t.property,a=t.unit,o=t.name,i=e.deviceState;return r.createElement("div",null,r.createElement("strong",null,r.createElement(en,{value:i[n],name:o})),a?r.createElement("small",{className:"text-muted ms-1"},a):null)},an=function(e){var t=e.feature.access;return r.createElement("div",{className:"alert alert-warning p-0",role:"alert"},"Unknown acces ",JSON.stringify(t,null,4))},on=function(){return(on=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const ln=function(e){var t=e.feature,n=t.access,a=t.endpoint,o=t.name,i=t.property,l=t.value_off,c=t.value_on,s=e.deviceState,u=e.onChange,p=e.minimal;return n&$t.ACCESS_WRITE?r.createElement(nn,{onChange:function(e){var t;return u(a,((t={})[i]=e,t))},value:s[i],valueOn:c,valueOff:l,minimal:p,name:o}):n&$t.ACCESS_STATE?r.createElement(rn,on({},e)):r.createElement(an,on({},e))};var cn=function(){return(cn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const sn=function(e){return r.createElement(Un,cn({type:"climate"},e))};var un=function(){return(un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},pn={position:[0,25,50,75,100].map((function(e){return{value:e,name:e+""}})),tilt:[0,25,50,75,100].map((function(e){return{value:e,name:e+""}}))};const mn=function(e){return r.createElement(Un,un({type:"cover"},e,{stepsConfiguration:pn}))};var dn=n(12085),fn=function(){return(fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},vn=function(e,t){switch(t){case"color_xy":var n=e,r=n.x,a=void 0===r?0:r,o=n.y,i=void 0===o?0:o,l=1/i*a,c=1/i*(1-a-i);return"#"+dn.xyz.hex([100*l,100,100*c]);case"color_hs":var s=e,u=s.hue,p=void 0===u?0:u,m=s.saturation,d=void 0===m?0:m;return"#"+dn.hsv.hex([p,d,100]);default:return"#FFFFFF"}},hn=function(e,t){switch(t){case"color_hs":var n=dn.hex.hsv(e),r=n[0],a=n[1];return n[2],{hue:r,saturation:a};case"color_xy":var o=dn.hex.xyz(e),i=o[0],l=o[1],c=o[2];return{x:i/(i+l+c),y:l/(i+l+c)};default:return{hex:e}}},yn=["#FF0018","#FFA52C","#FFFF41","#008018","#0000F9","#86007D"];const gn=function(e){var t=e.onChange,n=e.value,a=void 0===n?{}:n,o=e.format,i=e.steps,l=void 0===i?yn:i,c=e.minimal,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["onChange","value","format","steps","minimal"]),u=(0,r.useState)(vn(a,o)),p=u[0],m=u[1];return(0,r.useEffect)((function(){m(vn(a,o))}),[a,o]),r.createElement(r.Fragment,null,!c&&r.createElement("div",{className:"btn-group me-2 float-start"},l.map((function(e){return r.createElement(fe,{className:"btn",style:{backgroundColor:e},key:e,item:e,title:e,onClick:function(e){return t(hn(e,o))}},"")}))),r.createElement("input",fn({type:"color",className:"form-control form-control-color",value:p,style:{minWidth:40},onChange:function(e){t(hn(e.target.value,o))}},s)))},bn=function(e){for(var t,n,a=e.deviceState,o=e.feature,i=e.onChange,l=e.minimal,c={},s=0,u=o.features;s<u.length;s++){var p=u[s];c[p.name]=null!==(n=null===(t=a[o.property])||void 0===t?void 0:t[p.property])&&void 0!==n?n:0}return r.createElement(gn,{onChange:function(e){return i(o.endpoint,{color:e})},value:c,format:o.name,minimal:l})};function En(e){return null===e||["number","string","undefined"].includes(typeof e)}const _n=function(e){var t=e.onChange,n=e.values,a=e.value;return e.minimal?r.createElement("select",{className:"form-control",onChange:function(e){var r=n.find((function(t){return En(t)?t==e.target.value:t.value==e.target.value}));t(r)},value:En(a)?a:a.value},r.createElement("option",{key:"hidded",hidden:!0},"----"),n.map((function(e){return r.createElement("option",{key:En(e)?e:e.name,value:En(e)?e:e.value},En(e)?e:e.name)}))):r.createElement("div",{className:"btn-group me-2"},n.map((function(e){return r.createElement(fe,{className:i()("btn btn-outline-secondary",{active:En(e)?e===a:e.value==(En(a)?a:a.value)}),onClick:function(e){return t(e)},key:En(e)?e:e.name,item:En(e)?e:e.value,title:En(e)?e:e.description},En(e)?e:e.name)})))};var kn=function(){return(kn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const On=function(e){var t=e.onChange,n=e.feature,a=n.access,o=n.name,i=n.values,l=n.endpoint,c=n.property,s=e.deviceState,u=e.minimal;return a&$t.ACCESS_WRITE?r.createElement(_n,{onChange:function(e){var n;return t(l,((n={})[o]=e,n))},values:i,value:s[c],minimal:u}):a&$t.ACCESS_STATE?r.createElement(rn,kn({},e)):r.createElement(an,kn({},e))};var Nn=function(){return(Nn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},wn={brightness:[0,25,50,75,100].map((function(e){return{value:(t=e,n=[0,100],r=[0,255],a=r[0],o=r[1],i=n[0],(t-i)/(n[1]-i)*(o-a)+a),name:e+"%"};var t,n,r,a,o,i})),color_temp:[1e3,2e3,3e3,4e3,5e3,6500].map((function(e){return{value:1e6/e,name:e+"K"}}))};const Cn=function(e){return r.createElement(Un,Nn({type:"light"},e,{stepsConfiguration:wn}))};var Sn=function(){return(Sn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const xn=function(e){return r.createElement(Un,Sn({type:"lock"},e))};var jn=function(){return(jn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Pn=function(e){var t=e.onChange,n=e.value,a=e.min,o=e.max,l=e.unit,c=e.steps,s=e.minimal,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["onChange","value","min","max","unit","steps","minimal"]),p=(0,r.useState)(b(5)),m=p[0],d=(p[1],(0,r.useState)(n)),f=d[0],v=d[1];(0,r.useEffect)((function(){v(n)}),[n]);var h=void 0!==a&&void 0!==o;return r.createElement("div",{className:"input-group align-items-center"},!s&&c?r.createElement(_n,{values:c,onChange:t,value:f}):null,h?r.createElement("input",jn({id:m,min:a,max:o,type:"range",className:"form-range form-control border-0",value:f,onChange:function(e){return v(e.target.valueAsNumber)},onMouseUp:function(){return t(f)}},u)):null,(!s||!h)&&r.createElement("input",jn({type:"number",className:i()("form-control",{"ms-1":h}),value:f,onChange:function(e){return v(e.target.valueAsNumber)},onBlur:function(){return t(f)}},u,{style:h?{maxWidth:"100px"}:{}})),!s&&l?r.createElement("span",{className:"input-group-text",style:{minWidth:"66px"}},l):null)};var An=function(){return(An=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Rn=function(e){var t,n=e.feature,a=n.presets,o=n.access,i=n.endpoint,l=n.name,c=n.property,s=n.unit,u=n.value_max,p=n.value_min,m=e.deviceState,d=e.steps,f=e.onChange,v=e.minimal;return o&$t.ACCESS_WRITE?r.createElement(Pn,{onChange:function(e){var t;return f(i,((t={})[l]=e,t))},value:null!==(t=m[c])&&void 0!==t?t:0,min:p,max:u,steps:a&&a.length?a:d,unit:s,minimal:v}):o&$t.ACCESS_STATE?r.createElement(rn,An({},e)):r.createElement(an,An({},e))};var In=function(){return(In=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Dn=function(e){var t=e.onChange,n=e.value,a=e.unit,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["onChange","value","unit"]),i=(0,r.useState)(n),l=i[0],c=i[1];return(0,r.useEffect)((function(){c(n)}),[n]),r.createElement(r.Fragment,null,r.createElement("input",In({type:"text",className:"form-control",value:l,onChange:function(e){return c(e.target.value)},onBlur:function(){return t(l)}},o)),a?r.createElement("span",{className:"input-group-text",style:{minWidth:"66px"}},a):null)};var Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Mn=function(e){var t,n=e.feature,a=n.access,o=n.endpoint,i=n.name,l=n.property,c=e.deviceState,s=e.onChange;return a&$t.ACCESS_WRITE?r.createElement(Dn,{onChange:function(e){var t;return s(o,((t={})[i]=e,t))},value:null!==(t=c[l])&&void 0!==t?t:""}):a&$t.ACCESS_STATE?r.createElement(rn,Tn({},e)):r.createElement(an,Tn({},e))};var Fn=function(){return(Fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Ln=function(e){return r.createElement(Un,Fn({type:"switch"},e))};var qn=function(){return(qn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Gn=function(e){var t=e.feature,n=e.device,a=e.deviceState,o=e.stepsConfiguration,i=e.onRead,l=e.onChange,c=e.featureWrapperClass,s=e.minimal,u={key:JSON.stringify(t),device:n,deviceState:a,onChange:l,onRead:i,featureWrapperClass:c,minimal:s},p={key:JSON.stringify(t),feature:t,onRead:i,deviceState:a};return function(e){return"binary"===e.type}(t)?r.createElement(c,qn({},p),r.createElement(ln,qn({feature:t},u))):function(e){return"numeric"===e.type}(t)?r.createElement(c,qn({},p),r.createElement(Rn,qn({feature:t},u,{steps:null==o?void 0:o[t.name]}))):function(e){return"text"===e.type}(t)?r.createElement(c,qn({},p),r.createElement(Mn,qn({feature:t},u))):function(e){return"enum"===e.type}(t)?r.createElement(c,qn({},p),r.createElement(On,qn({feature:t},u))):Jt(t)?r.createElement(Cn,qn({feature:t},u)):function(e){return"switch"===e.type}(t)?r.createElement(Ln,qn({feature:t},u)):function(e){return"cover"===e.type}(t)?r.createElement(mn,qn({feature:t},u)):function(e){return"lock"===e.type}(t)?r.createElement(xn,qn({feature:t},u)):function(e){return"composite"===e.type&&("color_xy"==e.name||"color_hs"==e.name)}(t)?r.createElement(c,qn({},p),r.createElement(bn,qn({feature:t},u))):function(e){return"climate"===e.type}(t)?r.createElement(sn,qn({feature:t},u)):Qt(t)?r.createElement(c,qn({},p),r.createElement(Un,qn({type:"composite",feature:t},u))):r.createElement(c,qn({},p),r.createElement("pre",null,JSON.stringify(t,null,4)))},Bn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const Un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onChange=function(e,n){var r=t.props,a=r.onChange;Qt(r.feature)?t.setState(n):a(e,n)},t.onApplyClick=function(){var e,n=t.props,r=n.onChange,a=n.feature,o=a.endpoint,i=a.property;r(o,i?((e={})[i]=t.state,e):t.state)},t.onRead=function(e,n){var r,a=t.props,o=a.onRead,i=a.feature;Qt(i)?o(e,((r={})[i.property]=n,r)):o(e,n)},t}return Bn(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.feature,a=t.device,o=t.deviceState,l=(t.onRead,t.onChange,t.featureWrapperClass),c=t.minimal,s=n.features,u=[];if(c)u=u.concat(s.map((function(t){return r.createElement(Gn,{key:t.name+t.endpoint,feature:t,device:a,deviceState:o,onChange:e.onChange,onRead:e.onRead,featureWrapperClass:l,minimal:c})})));else{var p=Yt()(s,(function(e){var t;return null!==(t=e.endpoint)&&void 0!==t?t:"MAGIC_NO_ENDPOINT"}));for(var m in p.MAGIC_NO_ENDPOINT&&(u.push.apply(u,p.MAGIC_NO_ENDPOINT.map((function(t){return r.createElement(Gn,{key:t.name+t.endpoint,feature:t,device:a,deviceState:o,onChange:e.onChange,onRead:e.onRead,featureWrapperClass:l,minimal:c})}))),delete p.MAGIC_NO_ENDPOINT),p){var d=p[m];u.push(r.createElement("div",{key:m},"Endpoint: ",m,r.createElement("div",{className:"ps-4"},d.map((function(t){return r.createElement(Gn,{key:t.name+t.endpoint,feature:t,device:a,deviceState:o,onChange:e.onChange,onRead:e.onRead,featureWrapperClass:l,minimal:c})})))))}}return Qt(n)&&u.push(r.createElement("div",{key:n.name},r.createElement(fe,{className:i()("btn btn-primary float-end",{"btn-sm":c}),onClick:this.onApplyClick},"Apply"))),u},t}(r.Component);var Wn=function(e){var t,n=e.children,a=e.feature,o=e.onRead,i=null===(t=a.name)||void 0===t?void 0:t.startsWith("color_"),l=a.access&$t.ACCESS_READ||i;return r.createElement("div",{className:"row border-bottom py-1"},r.createElement("div",{className:"col-12 col-md-3"},r.createElement("label",{className:"col-form-label w-100"},r.createElement("div",{className:"d-flex justify-content-between"},r.createElement("strong",{title:JSON.stringify(a)},a.name),l?r.createElement(fe,{item:a,onClick:function(e){var t;o(a.endpoint,((t={})[e.property]="",t))},className:"btn btn-primary btn-sm"},r.createElement("i",{className:"fa fa-sync"})):null),a.description?r.createElement("small",{className:"d-block text-muted"},a.description):null)),r.createElement("div",{className:"col-12 col-md-9 d-flex align-items-center"},n))},Zn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zn(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.device,o=n.deviceStates,i=n.setDeviceState,l=n.getDeviceState,c=null!==(e=o.get(a.friendly_name))&&void 0!==e?e:{};return(null===(t=a.definition)||void 0===t?void 0:t.exposes)?r.createElement(Un,{feature:{features:a.definition.exposes},type:"composite",device:a,deviceState:c,onChange:function(e,t){i(a.friendly_name+(e?"/"+e:""),t)},onRead:function(e,t){l(a.friendly_name+(e?"/"+e:""),t)},featureWrapperClass:Wn}):"Device doesn't expose anything"},t}(r.Component);const Vn=(0,F.$)(["deviceStates"],pe)(Hn);var zn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jn=function(e){var t=e.label,n=e.clusters;return n.length?r.createElement("li",null,r.createElement("span",null,t),r.createElement("ul",null,n.map((function(e){return r.createElement("li",{key:e},r.createElement("span",null,e))})))):null};const Qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zn(t,e),t.prototype.render=function(){var e=this.props.device;return r.createElement("dl",{className:"_1A0umx4fPj4iWC5K7RUnD- row"},r.createElement("ul",null,r.createElement("li",null,r.createElement("span",null,e.ieee_address),r.createElement("ul",null,Array.from(e.endpoints.entries()).map((function(e){var t=e[0],n=e[1];return r.createElement("li",{key:t},r.createElement("span",null,"Endpoint ",r.createElement("strong",null,t)),r.createElement("ul",null,r.createElement(Jn,{label:"Output clusters",clusters:n.clusters.output}),r.createElement(Jn,{label:"Input clusters",clusters:n.clusters.input})))}))))))},t}(r.Component);var $n=n(51143),Kn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yn=function(){return(Yn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Xn={"ui:order":["friendly_name","retain","retention","qos","filtered_attributes","*"]},er=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateConfig=function(e){var n=e.formData,r=t.props;(0,r.setDeviceOptions)(r.device.ieee_address,n)},t}return Kn(t,e),t.prototype.render=function(){var e,t=this.props,n=t.bridgeInfo,a=n.config_schema,o=n.config,i=t.device,l=Yn(Yn({},null==o?void 0:o.device_options),null==o?void 0:o.devices[i.ieee_address]);return r.createElement($n.ZP,{schema:null===(e=a.definitions)||void 0===e?void 0:e.device,formData:l,onSubmit:this.updateConfig,uiSchema:Xn})},t}(r.Component);const tr=(0,F.$)(["deviceStates","bridgeInfo"],pe)(er);var nr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nr(t,e),t.prototype.renderContent=function(){var e=this.props,t=e.match,n=e.devices,a=t.params,o=a.tab,i=a.dev,l=n.get(i);switch(o){case"info":return r.createElement(st,{device:l});case"bind":return r.createElement(xt,{device:l});case"state":return r.createElement(zt,{device:l});case"exposes":return r.createElement(Vn,{device:l});case"clusters":return r.createElement(Qn,{device:l});case"reporting":return r.createElement(Zt,{device:l});case"settings":return r.createElement(tr,{device:l});default:return r.createElement(qe.l_,{to:"/device/"+i+"/info"})}},t.prototype.render=function(){var e=this.props,t=e.devices,n=e.match.params.dev,a=t.get(n);if(!a)return r.createElement("div",{className:"h-100 d-flex justify-content-center align-items-center"},"Unknown device");var o=function(e){return[{title:"About",url:"/device/"+e+"/info"},{title:"Exposes",url:"/device/"+e+"/exposes"},{title:"Bind",url:"/device/"+e+"/bind"},{title:"Reporting",url:"/device/"+e+"/reporting"},{title:"Settings",url:"/device/"+e+"/settings"},{title:"State",url:"/device/"+e+"/state"},{title:"Clusters",url:"/device/"+e+"/clusters"}]}(n);return r.createElement(r.Fragment,null,r.createElement("h1",{className:"h3"},a.friendly_name),r.createElement("div",{className:"tab"},r.createElement("ul",{className:"nav nav-tabs"},o.map((function(e){return r.createElement("li",{key:e.title,className:"nav-item"},r.createElement(Le.OL,{activeClassName:"active",className:"nav-link TxlAB4ufmQ5iWcatxCVRX",to:e.url},e.title))}))),r.createElement("div",{className:"tab-content"},r.createElement("div",{className:"tab-pane fade show active"},this.renderContent()))))},t}(r.Component),ar=(0,qe.EN)(rr);const or=(0,F.$)(["devices"],pe)(ar);var ir=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIdentifyClick=function(e){(0,t.props.touchlinkIdentify)(e)},t.onResetClick=function(e){(0,t.props.touchlinkReset)(e)},t}return ir(t,e),t.prototype.renderTouchlinkDevices=function(){var e=this,t=this.props,n=t.touchlinkDevices,a=t.devices,o=t.touchlinkIdentifyInProgress,l=t.touchlinkResetInProgress,c=o||l;return r.createElement("div",{className:"table-responsive"},r.createElement("table",{className:"table align-middle"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"},"#"),r.createElement("th",{scope:"col"},"ieee_address"),r.createElement("th",{scope:"col"},"friendly_name"),r.createElement("th",{scope:"col"},"channel"),r.createElement("th",{scope:"col"},""))),r.createElement("tbody",null,n.map((function(t,n){var s;return r.createElement("tr",{key:t.ieee_address},r.createElement("td",null,n+1),r.createElement("td",null,a.has(t.ieee_address)?r.createElement(Le.rU,{to:v(t.ieee_address)},t.ieee_address):t.ieee_address),r.createElement("td",null,null===(s=a.get(t.ieee_address))||void 0===s?void 0:s.friendly_name),r.createElement("td",null,t.channel),r.createElement("td",null,r.createElement("div",{className:"btn-group float-right",role:"group","aria-label":"Basic example"},r.createElement(fe,{disabled:c,item:t,title:"Identify",className:"btn btn-primary",onClick:e.onIdentifyClick},r.createElement("i",{className:i()("fa",{"fa-exclamation-triangle":!o,"fas fa-circle-notch fa-spin":o})})),r.createElement(fe,{disabled:c,item:t,title:"Factory reset",className:"btn btn-danger",onClick:e.onResetClick},r.createElement("i",{className:i()("fa",{"fa-broom":!l,"fas fa-circle-notch fa-spin":l})})))))})))))},t.prototype.renderNoDevices=function(){var e=this.props.touchlinkScan;return r.createElement(fe,{className:"btn btn-primary mx-auto d-block",onClick:e},"Scan")},t.prototype.render=function(){var e=this.props,t=e.touchlinkDevices,n=e.touchlinkScanInProgress,a=e.touchlinkScan;return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-header allign-middle"},"Detected ",t.length," touchlink devices.",r.createElement(fe,{title:"Rescan",className:"btn btn-primary btn-sm float-right",onClick:a},r.createElement("i",{className:"fa fa-sync"}))),r.createElement("div",{className:"card-body"},n?r.createElement("div",{className:"d-flex justify-content-center"},r.createElement("div",{className:"spinner-border",role:"status"},r.createElement("span",{className:"sr-only"},"Loading..."))):0===t.length?this.renderNoDevices():this.renderTouchlinkDevices()))},t}(r.Component);const cr=(0,F.$)(["touchlinkDevices","devices","touchlinkScanInProgress","touchlinkIdentifyInProgress","touchlinkResetInProgress"],pe)(lr);var sr=n(50361),ur=n.n(sr);const pr=JSON.parse('{"mqtt":{"ui:order":["base_topic","server","user","password","client_id","version","ca","key","cert","reject_unauthorized","*"]},"serial":{"ui:order":["port","adapter","disable_led","*"]},"frontend":{"ui:order":["port","host","*"]}}');var mr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dr="main",fr=["groups","devices","device_options","ban","whitelist","map_options"],vr=["object","array"],hr=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t.required&&(t.required=t.required.filter((function(t){return e.includes(t)})));for(var r=0,a=e;r<a.length;r++){var o=a[r];t.properties&&delete t.properties[o],delete n[o]}return{schema:t,config:n}},yr=[{title:"Settings",url:"/settings/settings"},{title:"Tools",url:"/settings/tools"},{title:"About",url:"/settings/about"},{title:"Raw",url:"/settings/bridge"}],gr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={keyName:dr},t.onSettingsSave=function(e){var n,r=e.formData,a=t.props.updateBridgeConfig,o=t.state.keyName;a(o===dr?r:((n={})[o]=r,n))},t}return mr(t,e),t.prototype.renderCategoriesTabs=function(){return r.createElement("ul",{className:"nav nav-tabs"},yr.map((function(e){return r.createElement("li",{key:e.url,className:"nav-item"},r.createElement(Le.OL,{className:"nav-link",activeClassName:"active",to:e.url},e.title))})))},t.prototype.render=function(){return r.createElement("div",{className:"tab"},this.renderCategoriesTabs(),r.createElement("div",{className:"tab-content h-100 p-0 p-sm-3"},r.createElement("div",{className:"tab-pane fade show active"},this.renderSwitcher())))},t.prototype.renderSwitcher=function(){switch(this.props.match.params.tab){case"tools":return this.renderTools();case"bridge":return this.renderBridgeInfo();case"about":return this.renderAbout();case"settings":return this.renderSettings();default:return r.createElement(qe.l_,{to:"/settings/settings"})}},t.prototype.renderAbout=function(){var e,t,n,a,o,i,l=this.props.bridgeInfo,c=null===(null===(e=l.version)||void 0===e?void 0:e.match(/^\d+\.\d+\.\d+$/))?l.version:r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/Koenkk/zigbee2mqtt/releases/tag/"+l.version},l.version),s=l.commit?r.createElement(r.Fragment,null,"commit: ",r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/Koenkk/zigbee2mqtt/commit/"+l.commit},l.commit)):null,u=[{title:"Zigbee2MQTT version",content:r.createElement(r.Fragment,null,c," ",s)},{title:"Coordinator type",content:r.createElement(r.Fragment,null,null!==(n=null===(t=l.coordinator)||void 0===t?void 0:t.type)&&void 0!==n?n:"Unknown")},{title:"Coordinator revision",content:r.createElement(r.Fragment,null,null!==(i=null===(o=null===(a=l.coordinator)||void 0===a?void 0:a.meta)||void 0===o?void 0:o.revision)&&void 0!==i?i:"Unknown")},{title:"Frontend version",content:"0.3.62"}];return r.createElement("div",{className:"p-3"},u.map((function(e){return r.createElement("dl",{key:e.title,className:"row"},r.createElement("dt",{className:"col-sm-3"},e.title),r.createElement("dd",{className:"col-sm-9"},e.content))})))},t.prototype.renderBridgeInfo=function(){var e=this.props.bridgeInfo;return r.createElement("div",{className:"p-3"},r.createElement("pre",null,JSON.stringify(e,null,4)))},t.prototype.renderTools=function(){var e=this.props,t=e.exportState,n=e.restartBridge;return r.createElement("div",{className:"p-3"},r.createElement(fe,{className:"btn btn-primary d-block mt-2",onClick:t},"Download state"),r.createElement(fe,{className:"btn btn-danger d-block mt-2",onClick:n,promt:!0},"Restart Zigbee2MQTT"))},t.prototype.getSettingsTabs=function(){var e=this.props.bridgeInfo.config_schema,t=void 0===e?{properties:{}}:e,n=Object.entries(t.properties).filter((function(e){return t=e[0],n=e[1],vr.includes(n.type)&&!fr.includes(t)||!(!n||!n.oneOf)&&n.oneOf.length>0;var t,n})).map((function(e){var t,n=e[0];return{name:n,title:null!==(t=e[1].title)&&void 0!==t?t:n}}));return n.unshift({name:dr,title:"Main"}),n},t.prototype.getSettingsInfo=function(){var e=this.state.keyName,t=this.props.bridgeInfo,n=t.config_schema,r=t.config,a=hr(fr,ur()(n),ur()(r)),o=a.schema,i=a.config[e];if(e===dr){var l=this.getSettingsTabs().map((function(e){return e.name}));o=(a=hr(l,a.schema,a.config)).schema,i=a.config}else i=a.config[e],a.schema.properties&&(o=a.schema.properties[e]);return{currentSchema:o,currentConfig:i}},t.prototype.renderSettingsTabs=function(){var e=this,t=this.getSettingsTabs(),n=this.state.keyName;return r.createElement("div",{className:"nav nav-pills"},t.map((function(t){return r.createElement("li",{key:t.name,className:"nav-item"},r.createElement("a",{className:i()("nav-link",{"bg-primary active":n===t.name}),"aria-current":"page",href:"#",onClick:function(n){e.setState({keyName:t.name}),n.preventDefault()}},t.title))})))},t.prototype.renderSettings=function(){var e=this.state.keyName,t=this.getSettingsInfo(),n=t.currentSchema,a=t.currentConfig;return r.createElement("div",{className:"tab"},this.renderSettingsTabs(),r.createElement("div",{className:"tab-content"},r.createElement("div",{className:"tab-pane active"},r.createElement($n.ZP,{key:e,schema:n,formData:a,onSubmit:this.onSettingsSave,uiSchema:pr[e]}))))},t}(r.Component),br=(0,qe.EN)(gr);const Er=(0,F.$)(["bridgeInfo"],pe)(br);var _r=[{href:"/",title:"Devices",exact:!0},{href:"/dashboard",title:"Dashboard"},{href:"/map",title:"Map"},{href:"/settings",title:"Settings"},{href:"/groups",title:"Groups"},{href:"/ota",title:"OTA"},{href:"/touchlink",title:"Touchlink"},{href:"/logs",title:"Logs"},{href:"/extensions",title:"Extensions (experimental)"}],kr=function(e){var t,n=e.devices,a=e.setPermitJoin,o=e.bridgeInfo,l=function(e){var t=(0,r.useState)(!1),n=t[0],a=t[1],o=(0,r.useRef)(null),i=function(e){"Escape"===e.key&&a(!1)},l=function(e){o.current&&!o.current.contains(e.target)&&a(!1)};return(0,r.useEffect)((function(){return document.addEventListener("keydown",i,!0),document.addEventListener("click",l,!0),function(){document.removeEventListener("keydown",i,!0),document.removeEventListener("click",l,!0)}})),{ref:o,isComponentVisible:n,setIsComponentVisible:a}}(),c=l.ref,s=l.isComponentVisible,u=l.setIsComponentVisible,p=(0,r.useState)({}),m=p[0],d=p[1],f=[],v=function(e){d(e),u(!1)};return n.forEach((function(e){"Router"==e.type&&f.push(r.createElement("li",{key:e.friendly_name},r.createElement(fe,{item:e,className:"dropdown-item",onClick:v},e.friendly_name)))})),r.createElement("div",{className:"btn-group text-nowrap"},r.createElement("button",{onClick:function(){a(!o.permit_join,m)},type:"button",className:"btn btn-outline-secondary"},o.permit_join?"Disable join":"Permit join"," (",null!==(t=null==m?void 0:m.friendly_name)&&void 0!==t?t:"All",")"),f.length?r.createElement(r.Fragment,null,r.createElement(fe,{type:"button",onClick:u,item:!s,className:"btn btn-outline-secondary dropdown-toggle dropdown-toggle-split","data-toggle":"dropdown","aria-expanded":"false"},r.createElement("span",{className:"visually-hidden"},"Toggle Dropdown")),r.createElement("ul",{ref:c,className:i()("dropdown-menu","_36Sntvyj-B3gg7Xj6xLUaY",{show:s})},r.createElement("li",{key:"all"},r.createElement(fe,{className:"dropdown-item",onClick:v},"All")),f)):null)};const Or=(0,F.$)(["bridgeInfo","devices"],pe)((function(e){var t=e.devices,n=e.setPermitJoin,a=e.bridgeInfo,o=e.restartBridge,l=(0,r.useRef)(),c=(0,r.useState)(!1),s=c[0],u=c[1];return function(e,t){(0,r.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}(l,(function(){u(!1)})),r.createElement("nav",{className:"navbar navbar-expand-md navbar-light"},r.createElement("div",{ref:l,className:"container-fluid"},r.createElement(Le.rU,{onClick:function(){return u(!1)},to:"/"},"Zigbee2MQTT"),r.createElement("button",{onClick:function(){u(!s)},className:"navbar-toggler",type:"button"},r.createElement("span",{className:"navbar-toggler-icon"})),r.createElement("div",{className:i()("navbar-collapse collapse",{show:s})},r.createElement("ul",{className:"navbar-nav"},_r.map((function(e){return r.createElement("li",{key:e.href,className:"nav-item"},r.createElement(Le.OL,{onClick:function(){return u(!1)},exact:e.exact,className:"nav-link",to:e.href,activeClassName:"active"},e.title))}))),r.createElement(kr,{devices:t,setPermitJoin:n,bridgeInfo:a})),a.restart_required?r.createElement(fe,{onClick:o,promt:!0,className:"btn btn-danger"},"Restart"):null))}));var Nr=function(){return(Nr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function wr(e){var t=e.name,n=e.onRename,a=(0,r.useState)(!1),o=a[0],i=a[1],l=function(e){var t=(0,r.useState)(e),n=t[0],a=t[1];return[n,function(e){var t;return a(Nr(Nr({},n),((t={})[e.currentTarget.name]=e.currentTarget.value,t)))}]}({friendlyName:t}),c=l[0],s=l[1];return r.createElement(r.Fragment,null,r.createElement(Ve,{isOpen:o},r.createElement(Ue,null,r.createElement("h3",null,"Rename group"),r.createElement("small",null,t)),r.createElement(We,null,r.createElement("div",{className:"mb-3"},r.createElement("label",{className:"form-label"},"Friendly name"),r.createElement("input",{name:"friendlyName",onChange:s,type:"text",className:"form-control",value:c.friendlyName}))),r.createElement(Ze,null,r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return i(!1)}},"Close"),r.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){n(t,c.friendlyName),i(!1)}},"Save changes"))),r.createElement(fe,{className:"btn btn-primary",onClick:function(){return i(!0)},title:"Rename group"},r.createElement("i",{className:"fa fa-edit"})))}var Cr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cr(t,e),t.prototype.getDeviceObj=function(){var e=this.props,t=e.groupAddress;return e.devices.get(t.ieee_address)},t.prototype.render=function(){var e=this.props,t=e.rowNumber,n=e.groupAddress,a=e.removeDeviceFromGroup,o=this.getDeviceObj();return r.createElement("tr",null,r.createElement("th",{scope:"row"},t+1),r.createElement("td",{className:"_2p1XqBiO9XLlCB-lT60VCH"},r.createElement(x,{className:i()("_3Z1i8qUrV2sErNF0__pVZt"),device:o})),r.createElement("td",null,r.createElement(Le.rU,{to:v(o.ieee_address)},o.friendly_name)),r.createElement("td",null,n.ieee_address),r.createElement("td",null,n.endpoint),r.createElement("td",null,o&&r.createElement(fe,{promt:!0,item:o.friendly_name,onClick:a,className:"btn btn-danger btn-sm float-right"},r.createElement("i",{className:"fa fa-trash"}))))},t}(r.Component),xr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRemove=function(e){var n=t.props,r=n.group;(0,n.removeDeviceFromGroup)(r.friendly_name,e)},t}return Cr(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.group,a=t.devices;return r.createElement("table",{className:"table table-sm"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"},"#"),r.createElement("th",{scope:"col"},"Pic"),r.createElement("th",{scope:"col"},"friendlyName"),r.createElement("th",{scope:"col"},"ieee_addr"),r.createElement("th",{scope:"col"},"Endpoint"),r.createElement("th",{scope:"col",className:"text-right"},"Action"))),r.createElement("tbody",null,n.members.map((function(t,n){return r.createElement(Sr,{key:t.ieee_address,removeDeviceFromGroup:e.onRemove,rowNumber:n,devices:a,groupAddress:t})}))))},t}(r.Component),jr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onSubmit=function(){var e=t.props,n=e.addDeviceToGroup,r=e.group,a=t.state,o=a.device,i=a.endpoint;n(i?o+"/"+i:o,r.friendly_name)},t.onDeviceSelect=function(e){var n=O(e);t.setState({device:e.ieee_address,endpoint:n[0]})},t.onEpChange=function(e){t.setState({endpoint:e})},t}return Cr(t,e),t.prototype.render=function(){var e=this.state,t=e.device,n=e.endpoint,a=this.props.devices,o=a.get(t),i=O(o);return r.createElement("div",{className:"row row-cols-lg-auto align-items-center"},r.createElement(mt,{type:"device",value:t,devices:a,onChange:this.onDeviceSelect}),r.createElement(vt,{values:i,value:n,onChange:this.onEpChange}),r.createElement(fe,{type:"button",onClick:this.onSubmit,className:"btn btn-primary"},"Add to group"))},t}(r.Component),Pr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={newGroupName:"",newGroupId:void 0},t.changeHandler=function(e){var n,r=e.target,a=r.name,o=r.value;t.setState(((n={})[a]=o,n))},t.onGroupCreateSubmit=function(){var e=t.state,n=e.newGroupName,r=e.newGroupId;(0,t.props.createGroup)(n,r)},t.removeGroup=function(e){(0,t.props.removeGroup)(e)},t.removeDeviceFromGroup=function(e,n){(0,t.props.removeDeviceFromGroup)(n,e)},t.renameGroup=function(e,n){(0,t.props.renameGroup)(e,n)},t}return Cr(t,e),t.prototype.renderGroupCreationForm=function(){var e=this.state,t=e.newGroupName,n=e.newGroupId;return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"input-group"},r.createElement("label",{htmlFor:"newGroupName",className:"sr-only"},"Group name"),r.createElement("input",{onChange:this.changeHandler,value:t,required:!0,type:"text",name:"newGroupName",className:"form-control",id:"newGroupName",placeholder:"new group name"}),r.createElement("label",{htmlFor:"newGroupName",className:"sr-only"},"Group id"),r.createElement("input",{onChange:this.changeHandler,value:void 0===n?"":n,type:"number",name:"newGroupId",className:"form-control",id:"newGroupId",placeholder:"enter group id if necessary"}),r.createElement(fe,{onClick:this.onGroupCreateSubmit,className:"btn btn-primary form-control"},"Create group"))))},t.prototype.renderGroups=function(){var e=this,t=this.props,n=t.groups,a=t.devices,o=t.addDeviceToGroup;return n.map((function(t){return r.createElement("div",{key:t.id,className:"card"},r.createElement("div",{className:"card-header",id:"heading"+t.id},r.createElement("h5",{className:"mb-0"},r.createElement("button",{className:"btn btn-link btn-sm"},t.friendly_name," (#",t.id,")"),r.createElement("div",{className:"btn-group float-right btn-group-sm",role:"group","aria-label":"Basic example"},r.createElement(wr,{name:t.friendly_name,onRename:e.renameGroup}),r.createElement(fe,{promt:!0,title:"Remove group",item:t.friendly_name,onClick:e.removeGroup,className:"btn btn-danger"},r.createElement("i",{className:"fa fa-trash"}))))),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"table-responsive"},r.createElement(xr,{group:t,devices:a,removeDeviceFromGroup:e.removeDeviceFromGroup}))),r.createElement("div",{className:"card-footer"},r.createElement(jr,{addDeviceToGroup:o,devices:a,group:t})))})).reverse()},t.prototype.render=function(){return r.createElement(r.Fragment,null,this.renderGroupCreationForm(),this.renderGroups())},t}(r.Component);const Ar=(0,F.$)(["groups","devices"],pe)(Pr);var Rr=n(18446),Ir=n.n(Rr),Dr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tr=function(){return(Tr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};const Mr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),e.stopPropagation();var n=t.props,r=n.column,a=n.onClick;a&&a(r)},t}return Dr(t,e),t.prototype.renderArrow=function(){var e=this.props,t=e.currentDirection,n=e.current,a=e.column;return Ir()(n,a)?"asc"==t?r.createElement("i",{className:"fa fa-sort-amount-down-alt"}):r.createElement("i",{className:"fa fa-sort-amount-down"}):r.createElement("i",{className:"fa fa-sort-amount-down invisible"})},t.prototype.render=function(){var e=this.props,t=e.children,n=(e.onClick,e.current,e.column,e.currentDirection,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["children","onClick","current","column","currentDirection"]));return r.createElement("th",Tr({},n),r.createElement("span",{className:"btn btn-link",onClick:this.onClick},t),this.renderArrow())},t}(r.Component),Fr="_1AmFhCTIk_ifBlEJGnLJuK";var Lr=function(e){var t=e.sortColumn,n=e.sortDirection,a=e.onSortChange,o=e.lastSeenIsAvaliable;return r.createElement("thead",null,r.createElement("tr",{className:"text-nowrap"},r.createElement("th",null,"#"),r.createElement("th",null,"Pic"),r.createElement(Mr,{className:Fr,column:"device.friendly_name",currentDirection:n,current:t,onClick:a},"Friendly name"),r.createElement(Mr,{className:Fr,column:"device.ieee_address",currentDirection:n,current:t,onClick:a},"IEEE address"),r.createElement(Mr,{className:Fr,column:"device.definition.vendor",currentDirection:n,current:t,onClick:a,title:"definition.vendor"},"Manufacturer"),r.createElement(Mr,{className:Fr,column:"device.definition.model",currentDirection:n,current:t,onClick:a},"Model"),r.createElement(Mr,{className:Fr,column:"state.linkquality",currentDirection:n,current:t,onClick:a},"LQI"),o&&r.createElement(Mr,{className:Fr,column:["state.last_seen","state.elapsed"],currentDirection:n,current:t,onClick:a},"Last seen"),r.createElement(Mr,{className:Fr,column:"state.battery",currentDirection:n,current:t,onClick:a},"Power"),r.createElement("th",null,"")))},qr=function(e){var t,n,a,o=e.device,i=e.deviceState,l=e.id,c=e.lastSeenIsAvaliable;return r.createElement("tr",{key:o.friendly_name,title:"available"==(null===(t=i.update)||void 0===t?void 0:t.state)?"Avaliable OTA update":null===(n=o.definition)||void 0===n?void 0:n.description},r.createElement("td",{className:"font-weight-bold"},l+1),r.createElement("td",{className:"_1KD_wxLENsmTnroATY4BrA"},r.createElement(x,{className:"_1kMXLbhsSotmS-uYUbIFl0",device:o,deviceStatus:i})),r.createElement("td",null,r.createElement(Le.rU,{to:v(o.ieee_address)},o.friendly_name)),r.createElement("td",null,o.ieee_address," (",h(o.network_address,4),")"),r.createElement("td",{className:"text-truncate text-nowrap position-relative"},r.createElement(tt,{device:o})),r.createElement("td",{title:null===(a=null==o?void 0:o.definition)||void 0===a?void 0:a.description},r.createElement(nt,{device:o})),r.createElement("td",null,r.createElement(en,{value:null==i?void 0:i.linkquality,name:"linkquality"})),c&&r.createElement("td",null,y(i.last_seen,i.elapsed)),r.createElement("td",{className:"text-left"},r.createElement(at,{source:o.power_source,battery:null==i?void 0:i.battery,batteryLow:i.battery_low})),r.createElement("td",null,r.createElement(Ke,{device:o,state:i})))},Gr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Br="ZigbeeTableState",Ur=function(e){function t(t){var n=e.call(this,t)||this;return n.saveState=function(){var e=n.state,t={sortDirection:e.sortDirection,sortColumn:e.sortColumn};try{localStorage.setItem(Br,JSON.stringify(t))}catch(e){(new U.Iq).error(e.toString())}},n.handleLongLoading=function(){if(0==n.props.devices.size){var e=r.createElement(r.Fragment,null,r.createElement("strong",null,"Loading devices takes too long time."),r.createElement("div",null,"Consider reading ",r.createElement("a",{href:"https://www.zigbee2mqtt.io/information/frontend.html"},"documentation")));n.setState({error:e})}},n.onSortChange=function(e,t){var r=n.state.sortColumn,a=n.state.sortDirection;Ir()(r,e)&&(a=t||("asc"==a?"desc":"asc")),n.setState({sortColumn:e,sortDirection:a},n.saveState)},n.state={sortDirection:"desc",sortColumn:"device.network_address",currentTime:Date.now(),sortedTableData:[]},n}return Gr(t,e),t.prototype.restoreState=function(){var e=this.state,t=e.sortColumn,n=e.sortDirection,r=localStorage.getItem(Br);if(r)try{var a=JSON.parse(r);this.setState(a)}catch(e){(new U.Iq).error(e.toString())}else this.onSortChange(t,n)},t.prototype.componentDidMount=function(){setTimeout(this.handleLongLoading,15e3),this.restoreState()},t.getDerivedStateFromProps=function(e,t){var n=t.sortColumn,r=t.sortDirection,a=e.devices,o=e.deviceStates,i=[];return a.forEach((function(e){var t;"Coordinator"!==e.type&&i.push({device:e,state:null!==(t=o.get(e.friendly_name))&&void 0!==t?t:{}})})),{sortedTableData:Z()(i,n,[r])}},t.prototype.renderError=function(){var e=this.state.error;return r.createElement("div",{className:"h-100 d-flex justify-content-center align-items-center"},r.createElement("div",{className:"d-flex align-items-center"},e))},t.prototype.render=function(){var e=this.state.error;return this.props.devices.size?this.renderDevicesTable():e?this.renderError():r.createElement("div",{className:"h-100 d-flex justify-content-center align-items-center"},r.createElement(Ne,null))},t.prototype.lastSeenIsAvaliable=function(){var e,t,n,r,a=this.props.bridgeInfo;return(null===(t=null===(e=null==a?void 0:a.config)||void 0===e?void 0:e.advanced)||void 0===t?void 0:t.elapsed)||"disable"!=(null===(r=null===(n=null==a?void 0:a.config)||void 0===n?void 0:n.advanced)||void 0===r?void 0:r.last_seen)},t.prototype.renderDevicesTable=function(){var e=this,t=this.state,n=t.sortedTableData,a=t.sortColumn,o=t.sortDirection;return r.createElement("div",{className:"card"},r.createElement("div",{className:"table-responsive"},r.createElement("table",{className:"table align-middle"},r.createElement(Lr,{lastSeenIsAvaliable:this.lastSeenIsAvaliable(),sortColumn:a,sortDirection:o,onSortChange:this.onSortChange}),r.createElement("tbody",null,n.map((function(t,n){var a=t.device,o=t.state;return r.createElement(qr,{key:a.friendly_name,device:a,deviceState:o,id:n,lastSeenIsAvaliable:e.lastSeenIsAvaliable()})}))))))},t}(r.Component);const Wr=(0,F.$)(["devices","deviceStates","bridgeInfo"],pe)(Ur);var Zr=n(3522),Hr=n.n(Zr),Vr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zr="all",Jr=function(e){var t=e.text;return r.createElement(r.Fragment,null,t)},Qr=function(e){var t=e.text,n=void 0===t?"":t,a=e.highlight,o=void 0===a?"":a;if(!o.trim())return r.createElement(Jr,{text:n});var i=new RegExp("("+Hr()(o)+")","gi"),l=n.split(i);return r.createElement(r.Fragment,null,l.filter((function(e){return e})).map((function(e,t){return i.test(e)?r.createElement("mark",{key:t},e):r.createElement(Jr,{key:t,text:e})})))},$r=[zr,"debug","info","warn","error"],Kr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={search:"",logLevel:zr},t}return Vr(t,e),t.prototype.renderSearch=function(){var e=this,t=this.state.search;return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},r.createElement("form",{className:"row row-cols-lg-auto g-3 align-items-center"},r.createElement("div",{className:"col-12"},r.createElement("label",{htmlFor:"log-level",className:"form-label"},"Show only"),r.createElement("select",{id:"log-level",className:"form-select",onChange:function(t){return e.setState({logLevel:t.target.value})}},$r.map((function(e){return r.createElement("option",{key:e,value:e},e)})))),r.createElement("div",{className:"col-12"},r.createElement("label",{htmlFor:"search-filter",className:"form-label"},"Filter by text"),r.createElement("input",{id:"search-filter",className:"form-control col-10",placeholder:"Enter search criteria",value:t,onChange:function(t){return e.setState({search:t.target.value})},type:"text"})))))},t.prototype.render=function(){var e=this.props.logs,t=this.state,n=t.search,a=t.logLevel,o=new RegExp(Hr()(n),"gi");return e=e.filter((function(e){return(a===zr||e.level===a)&&(!n||o.test(e.message))})).sort(),r.createElement(r.Fragment,null,this.renderSearch(),r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},0==e.length?r.createElement("h1",null,"You don't have ",a===zr?"any":a," logs"):null,r.createElement("div",{className:"overflow-auto"},e.map((function(e,t){return r.createElement("div",{key:t},a===zr&&r.createElement(r.Fragment,null,r.createElement("span",{className:i()("badge",{"bg-danger":"error"===e.level,"bg-warning":"warning"===e.level,"bg-info":"info"===e.level,"bg-secondary":!1===["error","warning","info"].includes(e.level)},"text-capitalize")},e.level),""),r.createElement("code",null,r.createElement(Qr,{text:e.message,highlight:n})))}))))))},t}(r.Component);const Yr=(0,F.$)(["logs","bridgeInfo"],pe)(Kr);var Xr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ea=function(){return(ea=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ta=function(e){var t,n,a=e.device,o=e.state,i=e.checkOTA,l=e.updateOTA;switch(null===(t=null==o?void 0:o.update)||void 0===t?void 0:t.state){case"updating":return r.createElement(r.Fragment,null,r.createElement("div",{className:"progress"},r.createElement("div",{className:"progress-bar progress-bar-striped progress-bar-animated",style:{width:o.update.progress+"%"}},o.update.progress,"%")),r.createElement("div",null,"Remaining time ",(n=o.update.remaining)?[Math.floor(n/3600),Math.floor(n/60)%60,Math.floor(n%60)].map((function(e){return e<10?"0"+e:e})).filter((function(e,t){return"00"!==e||t>0})).join(":"):"N/A"));case"available":return r.createElement(fe,{className:"btn btn-danger btn-sm",onClick:l,item:a.friendly_name,title:"Update OTA",promt:!0},"Update OTA");default:return r.createElement(fe,{className:"btn btn-primary btn-sm",onClick:i,item:a.friendly_name,title:"Check OTA"},"Check OTA")}},na=function(e){var t,n=e.device,a=e.state,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["device","state"]);return r.createElement("tr",null,r.createElement("td",null,r.createElement(Le.rU,{to:v(n.ieee_address)},n.friendly_name)),r.createElement("td",{className:"text-truncate text-nowrap position-relative"},r.createElement(tt,{device:n})),r.createElement("td",{title:null===(t=null==n?void 0:n.definition)||void 0===t?void 0:t.description},r.createElement(nt,{device:n})),r.createElement("td",null,n.date_code),r.createElement("td",null,n.software_build_id),r.createElement("td",null,r.createElement(ta,ea({device:n,state:a},o))))},ra=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkAllOTA=function(){var e=t.props.checkOTA;t.getAllOtaDevices().forEach((function(t){var n=t[1];return e(n.friendly_name)}))},t}return Xr(t,e),t.prototype.getAllOtaDevices=function(){var e=this.props.devices;return Array.from(e).filter((function(e){var t,n=e[1];return null===(t=null==n?void 0:n.definition)||void 0===t?void 0:t.supports_ota}))},t.prototype.render=function(){var e=this.props,t=e.deviceStates,n={checkOTA:e.checkOTA,updateOTA:e.updateOTA},a=this.getAllOtaDevices();return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"},"Friendly name"),r.createElement("th",null,"Manufacturer"),r.createElement("th",null,"Model"),r.createElement("th",null,"Firmware build date"),r.createElement("th",null,"Firwmare version"),r.createElement("th",null,r.createElement(fe,{className:"btn btn-danger btn-sm",onClick:this.checkAllOTA,promt:!0},"Check all OTA")))),r.createElement("tbody",null,0===a.length?r.createElement("tr",null,r.createElement("td",{colSpan:6},"You don't have any devices that support OTA")):null,a.map((function(e){var a=e[0],o=e[1];return r.createElement(na,ea({key:a,device:o,state:t.get(o.friendly_name)},n))}))))))},t}(r.Component);const aa=(0,F.$)(["devices","deviceStates"],pe)(ra);var oa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();const ia=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.donwloadState=function(){k(B.getState(),"state.json")},t}return oa(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.render=function(){var e=this.state.error;if(e){var t={title:"Got error: "+e.message,body:["DESCRIBE HERE WHAT HAPPENED AND WHAT YOU EXPECTED TO HAPPEN","\n\n\n\n\n","**Current url**: "+window.location.toString(),"**Previous url**: "+document.referrer,"\n","**Error type**: "+(null==e?void 0:e.name),"**Error message**: "+(null==e?void 0:e.message),"\n\n",null==e?void 0:e.stack].join("\n")},n="https://github.com/nurikk/z2m-frontend/issues/new?"+new URLSearchParams(t).toString();return r.createElement("div",{className:"container"},r.createElement("h1",{className:"text-danger"},"Hello, you've found a bug. Congratulations!"),r.createElement("ol",null,r.createElement("li",null,r.createElement("strong",null,"Calm down")),r.createElement("li",null,r.createElement("strong",null,"Raise a github issue ",r.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},"here"))),r.createElement("li",null,r.createElement("strong",null,r.createElement("span",{className:"btn btn-link p-0",onClick:this.donwloadState},"Download this file")," and attach to the issue")),r.createElement("li",null,r.createElement("strong",null,"Take a screenshot of this page and attach to the issue"))),r.createElement("div",null,r.createElement("div",null,e.name),r.createElement("div",null,e.message),r.createElement("pre",null,e.stack)))}return this.props.children},t.prototype.componentDidUpdate=function(e){var t=this.props.location.pathname;e.location.pathname!==t&&this.setState({error:void 0})},t}(r.Component);var la=["linkquality"];const ca=function(e){var t=e.device,n=e.deviceState,a=n.last_seen,o=n.linkquality,i=t.definition.exposes,l=[];return i.filter((function(e){return la.includes(e.name)})).forEach((function(e){switch(e.name){case"linkquality":o&&l.push(r.createElement("span",{key:"linkquality",className:"me-1"},r.createElement("i",{className:"fa fa-signal fa-fw"})," ",o," LQI"))}})),l.push(r.createElement(at,{key:"power",source:t.power_source,battery:n.battery})),r.createElement("footer",{className:"card-footer pt-0"},r.createElement("div",{className:"row justify-content-between flex-nowrap"},r.createElement("div",{title:"last update",className:"col text-truncate"},y(a)),r.createElement("div",{className:"col col-auto text-truncate"},l)))},sa=function(e){var t=e.onChange,n=e.onRead,a=e.device,o=e.deviceState,l=e.feature.features,c=e.featureWrapperClass;return r.createElement("div",{className:"col-xl-3 col-lg-4 col-sm-6 col-12 d-flex"},r.createElement("div",{className:"flex-fill card flex-shrink-1"},r.createElement("div",{className:"card-header text-truncate pb-0"},r.createElement(Le.rU,{to:v(a.ieee_address)},a.friendly_name)),r.createElement("div",{className:"align-items-center card-body row"},r.createElement(x,{device:a,className:i()("_2sZwYIX5ipSoyWG2H7AU79","col col-1")}),r.createElement("div",{className:"col col-11"},r.createElement(Un,{feature:{features:l},type:"composite",device:a,deviceState:o,onChange:t,onRead:n,featureWrapperClass:c,minimal:!0}))),r.createElement(ca,{device:a,deviceState:o})))};var ua=n(68929),pa=n.n(ua),ma=n(18029),da=n.n(ma),fa={humidity:["text-info","fa-tint"],illuminance:["fa-sun"],pressure:["fa-cloud-download-alt"],co2:["fa-atom","text-warning"],voltage:["fa-bolt","text-success"],state:["fa-star-half-alt"],brightness:["fa-sun"],occupancy:["fa-walking"],current:["fa-copyright","text-warning"],power:["fa-power-off","text-success"],energy:["fa-plug","text-info"],frequency:["fa-wave-square"],tamper:["fa-exclamation-circle"],smoke:["fa-smoking","text-danger"],radiation_dose_per_hour:["fa-radiation","text-danger"],radioactive_events_per_minute:["fa-radiation-alt","text-warning"],power_factor:["fa-industry","text-danger"],color_xy:["fa-palette"],color_hs:["fa-palette"],color_temp:["fa-sliders-h"],illuminance_lux:["fa-sun"],soil_moisture:["fa-fill-drip"],water_leak:["fa-water"]},va=function(e){var t=e.children,n=e.feature,a=e.deviceState,o=void 0===a?{}:a,l=function(e,t){var n,r,a,o=[];switch(e){case"temperature":o.push(i()("text-danger",(a="fa-thermometer-empty",(r=t)>=30?a="fa-thermometer-full":r>=25?a="fa-thermometer-three-quarters":r>=20?a="fa-thermometer-half":r>=15&&(a="fa-thermometer-quarter"),a)));break;case"contact":o.push(i()({"fa-door-closed text-muted":t,"fa-door-open text-primary":!t}));break;case"occupancy":o.push(i()({"text-warning":t}));break;case"water_leak":o.push(i()({"text-primary":t}))}return(o=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,l=o.length;i<l;i++,a++)r[a]=o[i];return r}(o,null!==(n=fa[e])&&void 0!==n?n:[])).length||o.push("invisible"),i()(o)}(n.name,o[n.property]);return r.createElement("div",{className:"d-flex align-items-center"},l&&r.createElement("div",{className:"me-1"},r.createElement("i",{className:"fa fa-fw "+l})),r.createElement("div",{className:"flex-shrink-1 flex-grow-1"},da()(pa()(n.name)),n.endpoint?" ("+n.endpoint+")":null),r.createElement("div",{className:"flex-shrink-0"},t))},ha=function(){return(ha=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ya=["linkquality","battery","battery_low","illuminance_lux","color_temp_startup","voltage","strength"],ga=["state","brightness","color_temp"],ba=["light"],Ea=["",null,void 0],_a=function(e,t){void 0===t&&(t={});var n=e.access,r=e.property,a=e.name,o=e.type,i=e.features;if(Jt(e)){i=i.map((function(e){return _a(e,r?t[r]:t)})).filter((function(e){return e}));var l=Yt()(i,"property");i=Object.values(l).map((function(e){return e[0]}))}var c,s=ha(ha({},e),{features:i});return(ga.includes(a)||ba.includes(o)||!!(!n||n&$t.ACCESS_STATE&&!Ea.includes(t[r]))&&!ya.includes(a)&&(n&$t.ACCESS_STATE&&(c=n)&&!(c&c-1)||!!(Array.isArray(i)&&i.length>0)))&&s};const ka=(0,F.$)(["devices","deviceStates"],pe)((function(e){var t=e.setDeviceState,n=e.getDeviceState,a=e.deviceStates;return r.createElement("div",{className:"row"},Array.from(e.devices).filter((function(e){return e[1].supported})).map((function(e){var t,n=e[1];return{device:n,deviceState:null!==(t=a.get(n.friendly_name))&&void 0!==t?t:{}}})).map((function(e){var t,n,r=e.device,a=e.deviceState,o=(null!==(n=null===(t=r.definition)||void 0===t?void 0:t.exposes)&&void 0!==n?n:[]).map((function(e){return _a(e,a)})).filter((function(e){return e}));return{device:r,deviceState:a,filteredFeatures:o}})).filter((function(e){return e.filteredFeatures.length>0})).map((function(e){var a=e.device,o=e.deviceState,i=e.filteredFeatures;return r.createElement(sa,{key:a.ieee_address,feature:{features:i},device:a,deviceState:o,onChange:function(e,n){return t(a.friendly_name+(e?"/"+e:""),n)},onRead:function(e,t){return n(a.friendly_name+(e?"/"+e:""),t)},featureWrapperClass:va})})))}));var Oa=n(79307),Na=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wa="hardcoded-new-extension-key",Ca=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.loadExtension=function(e){var n=e.target.value,r=t.props,a=r.readExtension,o=r.updateExtensionCode;if(n===wa){var i=Date.now()+"",l=prompt("Enter new extension name","user-extension"+i+".js"),c=Oa.replace(/%TS%/g,i);null!==l&&(o(l,c),t.setState({currentExtension:l}))}else t.setState({currentExtension:n}),a(n)},t.onExtensionCodeChange=function(e){var n=t.props.updateExtensionCode,r=t.state.currentExtension,a=e.target.value;r&&n(r,a)},t.onSaveClick=function(){var e=t.props.saveExtensionCode,n=t.state.currentExtension;n&&e(n)},t}return Na(t,e),t.prototype.render=function(){var e,t=this.state.currentExtension,n=this.props.extensionCode,a=null!==(e=n[t])&&void 0!==e?e:"";return r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},r.createElement("select",{value:t,className:"form-control",onChange:this.loadExtension},r.createElement("option",{key:"hidden",hidden:!0},"Select extension to edit"),r.createElement("option",{key:wa,value:wa},"Create new extension"),Object.keys(n).map((function(e){return r.createElement("option",{key:e,value:e},e)}))),r.createElement("textarea",{onChange:this.onExtensionCodeChange,className:"form-control",rows:10,value:a}),r.createElement(fe,{disabled:!t,onClick:this.onSaveClick,className:"btn btn-primary"},"Save")))},t}(r.Component);const Sa=(0,F.$)(["extensions","extensionCode"],pe)(Ca),xa=(0,F.$)(["bridgeState"],pe)((function(e){var t=e.bridgeState,n=(0,r.useState)("online"!==t),a=n[0],o=n[1];return(0,r.useEffect)((function(){o("online"!==t)}),[t]),r.createElement(Ve,{isOpen:a},r.createElement(Ue,null,"Zigbee2MQTT"),r.createElement(We,null,r.createElement("div",null,"Hello, Zigbee2MQTT in status ",r.createElement("span",{className:"text-danger"},t),"."),r.createElement("div",null,"Please wait....")),r.createElement(Ze,null,r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return o(!1)}},"Close")))}));var ja=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pa=function(){return(Pa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};X.connect();var Aa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ja(t,e),t.prototype.render=function(){return r.createElement(F.z,{store:B},r.createElement(Le.UT,null,r.createElement(xa,null),r.createElement("div",{className:"main"},r.createElement(Or,null),r.createElement("main",{className:"content p-0 p-sm-3"},r.createElement("div",{className:"container-fluid p-0 h-100"},r.createElement(qe.rs,null,r.createElement(qe.AW,{path:"/ota",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(aa,null))}}),r.createElement(qe.AW,{path:"/map",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Fe,null))}}),r.createElement(qe.AW,{path:"/device/:dev/:tab?",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(or,null))}}),r.createElement(qe.AW,{path:"/settings/:tab?",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Er,null))}}),r.createElement(qe.AW,{path:"/groups",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Ar,null))}}),r.createElement(qe.AW,{path:"/logs",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Yr,null))}}),r.createElement(qe.AW,{path:"/touchlink",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(cr,null))}}),r.createElement(qe.AW,{path:"/dashboard",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(ka,null))}}),r.createElement(qe.AW,{path:"/extensions",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Sa,null))}}),r.createElement(qe.AW,{path:"/",render:function(e){return r.createElement(ia,Pa({},e),r.createElement(Wr,null))}})))))))},t}(r.Component);Ge.render(r.createElement(Aa,null),document.getElementById("root"))},79307:e=>{"use strict";e.exports="class MyExampleExtension%TS% {\n    constructor(zigbee, mqtt, state, publishEntityState, eventBus, settings, logger) {\n        logger.info('Loaded  MyExampleExtension%TS%');\n        mqtt.publish('example/extension', 'hello from MyExampleExtension%TS%')\n    }\n}\n\nmodule.exports = MyExampleExtension%TS%;\n"},48454:(e,t,n)=>{"use strict";e.exports=n.p+"d921749ee5fe6bc67e4c.png"},59858:e=>{"use strict";e.exports='{\n  "devices": {"dataType":"Map","value":[]},\n  "deviceStates": {"dataType":"Map","value":[]},\n  "touchlinkDevices": [],\n  "touchlinkScanInProgress": false,\n  "touchlinkIdentifyInProgress": false,\n  "touchlinkResetInProgress": false,\n  "networkGraph": {\n    "links": [],\n    "nodes": []\n  },\n  "networkGraphIsLoading": false,\n  "groups": [],\n  "bridgeState": "online",\n  "bridgeConfig": {\n  },\n  "bridgeInfo": {\n    "configSchema": {\n      "properties": {},\n      "required": []\n    },\n    "config": {}\n  },\n  "logs": [],\n  "extensionCode": {}\n}\n'}},0,[[84848,666,718]]]);
//# sourceMappingURL=main.9be78d1901f5b2511351.js.map